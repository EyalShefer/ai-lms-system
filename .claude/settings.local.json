{
  "permissions": {
    "allow": [
      "Bash(npx tsc:*)",
      "Bash(git push:*)",
      "Bash(npx tsx:*)",
      "Bash(git add:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: Complete exam generation system refactoring with dedicated architecture\n\nImplements full separation of exam and learning pipelines for scalability and maintainability.\n\nBackend Changes:\n- âœ¨ NEW: examPrompts.ts - Dedicated exam prompts \\(Temperature 0.3, no hints\\)\n- âœ¨ NEW: examArchitect.ts - Strategic test planning \\(The Brain\\)\n- âœ¨ NEW: examGenerator.ts - Parallel question generation \\(The Hands\\)\n- âœ¨ NEW: examGuardian.ts - Exam integrity validation with auto-repair\n- âœ¨ NEW: examController.ts - Complete exam pipeline orchestration\n- âœ¨ NEW: generateExam Cloud Function - Listens to exam_generation_queue\n\nFrontend Changes:\n- ðŸ”§ UPDATED: gemini.ts - Smart routing to exam_generation_queue for productType=''exam''\n- ðŸ”§ UPDATED: CourseEditor.tsx - Pass productType, activityLength, taxonomy to queue\n\nKey Features:\n- âœ… Zero conditionals - Complete code separation \\(removed 50+ if statements\\)\n- âœ… Temperature Fix - 0.3 for deterministic exam generation\n- âœ… ExamGuardian - Prevents hints/teaching content leakage\n- âœ… Auto-Repair - Automatically removes hints before validation\n- âœ… Dedicated Queue - exam_generation_queue isolated from learning\n- âœ… Quality Scoring - Guardian provides 0-100 quality assessment\n\nArchitecture:\n- 3-Stage Pipeline: Architect \\(Plan\\) â†’ Generator \\(Create\\) â†’ Guardian \\(Validate\\)\n- Parallel question generation for speed\n- Local + AI validation for reliability\n- Comprehensive error handling and logging\n\nBreaking Changes: None \\(backward compatible\\)\nMigration: Deploy with: firebase deploy --only functions:generateExam\n\nðŸ¤– Generated with [Claude Code]\\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(npm run build:*)",
      "Bash(npm run dev:*)",
      "Bash(timeout 5 head:*)",
      "Bash(git commit -m \"$\\(cat <<''EOF''\nfeat: Major Teacher Experience & Content Generation Enhancements\n\nThis commit consolidates multiple advanced features developed by different\nAnthropic agents, including Teacher Cockpit improvements, AI-powered content\ngeneration, and pedagogical infrastructure upgrades.\n\n## ðŸŽ¨ Teacher Cockpit Enhancements \\(TeacherCockpit.tsx\\)\n- âœ¨ Text-to-Speech Integration: Added TTS playback for lesson scripts\n- âœ¨ Smart Infographic Generator: Auto-detect content type and generate visual aids\n  * Flowcharts, Timelines, Comparisons, Cycle diagrams\n  * Smart content analysis with suitability warnings\n  * Preview system before insertion\n- âœ¨ Pedagogical Phase Icons: Dynamic icons based on lesson structure\n- âœ¨ Block Management: Enhanced drag-drop, reordering, deletion\n- âœ¨ AI Refinement Toolbar: Improved UX for content editing\n- ðŸ“„ PDF Export: Export complete lesson plans to PDF\n\n## ðŸ¤– AI Content Generation \\(geminiApi.ts + CourseEditor.tsx\\)\n- âœ¨ Progressive Lesson Generation: Async unit-by-unit content creation\n- âœ¨ Auto-Generated Interactive Blocks: AI creates activities automatically\n- âœ¨ Visual Assets Generator: AI-powered image generation for lessons\n- âœ¨ Infographic Generation: Convert text to visual diagrams via Mermaid\n- ðŸ”§ Rate Limiting Protection: Prevent 429 errors with queue system\n- ðŸ”§ PDF Text Extraction: Improved file processing pipeline\n\n## ðŸ“š New Services & Utilities\n- âœ¨ textToSpeechService.ts: Web Speech API integration for Hebrew TTS\n- âœ¨ pdfExportService.ts: Lesson plan PDF export with proper formatting\n- âœ¨ pedagogicalIcons.ts: Centralized icon mapping system\n- âœ¨ infographicDetector.ts: Smart content analysis for diagram recommendations\n- âœ¨ infographicCache.ts: Caching layer for generated infographics\n- âœ¨ imagenService.ts: Image generation service wrapper\n- âœ¨ TextToSpeechButton.tsx: Reusable TTS component\n\n## ðŸ“– Documentation\n- ðŸ“ INFOGRAPHIC_FEATURE.md: Complete infographic system documentation\n- ðŸ“ INFOGRAPHIC_QUICKSTART.md: Quick start guide for teachers\n- ðŸ“ PODCAST_VOICE_SYSTEM.md: Voice customization documentation\n- ðŸ“ LESSON_PLAN_IMPROVEMENTS.md: Teacher experience improvements\n\n## ðŸ”§ Backend Improvements\n- ðŸ“¦ Added puppeteer for server-side rendering\n- ðŸ”§ Enhanced prompts with teacher_guidelines for open questions\n- ðŸ”§ Improved rate limiting middleware\n- ðŸ”§ Better Gemini response parsing\n\n## ðŸŽ¨ UI/UX Enhancements\n- ðŸ’… New lesson section styles \\(Hook, Instruction, Practice, Summary\\)\n- ðŸ’… Responsive design improvements\n- ðŸ’… Enhanced animations and transitions\n- ðŸ’… Better RTL support for Hebrew content\n\n## ðŸ“¦ Dependencies\nClient:\n- Added: @react-pdf/renderer@^4.2.0 \\(PDF export\\)\n- Added: mermaid@^11.4.1 \\(Infographic rendering\\)\n\nBackend:\n- Added: puppeteer@^23.11.1 \\(Server-side rendering\\)\n- Upgraded: firebase-functions@^6.2.0\n\n## ðŸ“Š Impact Summary\n- 17 files modified \\(983 lines added, 201 removed\\)\n- 9 new files created\n- 4 new documentation files\n- Zero conflicts with previous scoring system improvements\n\nAll changes tested and validated. Ready for production deployment.\n\nðŸ¤– Generated with Claude Code \\(https://claude.com/claude-code\\)\n\nCo-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>\nEOF\n\\)\")",
      "Bash(git reset:*)",
      "Bash(git commit:*)",
      "Bash(node:*)"
    ]
  }
}
