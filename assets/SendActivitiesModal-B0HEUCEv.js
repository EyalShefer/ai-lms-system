import{c as $,x as w,n as U,p as C,av as W,bl as K,aw as Y,aM as G,ax as _,r as x,j as e,bM as A,D as V,E as k,G as X}from"./index-1x3sw4DL.js";import{I as H,a as J}from"./IconCopy-BTB5ujr3.js";import{I as Q}from"./IconMail-BDnpP6ds.js";/**
 * @license @tabler/icons-react v3.36.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M3 21l1.65 -3.8a9 9 0 1 1 3.4 2.9l-5.05 .9",key:"svg-0"}],["path",{d:"M9 10a.5 .5 0 0 0 1 0v-1a.5 .5 0 0 0 -1 0v1a5 5 0 0 0 5 5h1a.5 .5 0 0 0 0 -1h-1a.5 .5 0 0 0 0 1",key:"svg-1"}]],ee=$("outline","brand-whatsapp","BrandWhatsapp",Z);/**
 * @license @tabler/icons-react v3.36.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M8 9h-1a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-8a2 2 0 0 0 -2 -2h-1",key:"svg-0"}],["path",{d:"M12 14v-11",key:"svg-1"}],["path",{d:"M9 6l3 -3l3 3",key:"svg-2"}]],se=$("outline","share-2","Share2",te),ie=["multiple-choice","open-question","fill_in_blanks","ordering","categorization","memory_game","true_false_speed","drag_and_drop","hotspot","audio-response","interactive-chat","matching","highlight","sentence_builder","image_labeling","table_completion","text_selection","rating_scale","matrix"],ae=["text","video","image","pdf","infographic","mindmap","podcast"],ne=t=>{const a=t.content;return typeof a=="object"&&a!==null&&"teach_content"in a&&a.teach_content&&!a.text?"teacher_only":ie.includes(t.type)?"student_activity":(ae.includes(t.type),"presentation")},T=t=>{if(ne(t)!=="student_activity")return!1;const i=t.content;return i?typeof i=="object"&&("question"in i&&i.question||"instruction"in i&&i.instruction||"items"in i&&Array.isArray(i.items)&&i.items.length>0)?!0:typeof i=="string"&&i.length>0:!1},le=t=>(t.activityBlocks||[]).filter(T),B=t=>({"multiple-choice":"×©××œ×” ×××¨×™×§××™×ª","open-question":"×©××œ×” ×¤×ª×•×—×”",fill_in_blanks:"×”×©×œ××ª ××©×¤×˜×™×",ordering:"×¡×™×“×•×¨ ×¨×¦×£",categorization:"××™×•×Ÿ ×œ×§×˜×’×•×¨×™×•×ª",memory_game:"××©×—×§ ×–×™×›×¨×•×Ÿ",true_false_speed:"× ×›×•×Ÿ/×œ× × ×›×•×Ÿ",drag_and_drop:"×’×¨×•×¨ ×•×©×—×¨×¨",hotspot:"× ×§×•×“×•×ª ×—××•×ª","audio-response":"×ª×©×•×‘×” ×§×•×œ×™×ª","interactive-chat":"×¦'××˜ ××™× ×˜×¨××§×˜×™×‘×™",text:"×˜×§×¡×˜",video:"×•×™×“××•",image:"×ª××•× ×”",pdf:"××¡××š PDF",infographic:"××™× ×¤×•×’×¨×¤×™×§×”",mindmap:"××¤×ª ×—×©×™×‘×”",podcast:"×¤×•×“×§××¡×˜",matching:"×”×ª×××”",highlight:"×¡×™××•×Ÿ ×‘×˜×§×¡×˜",sentence_builder:"×‘× ×™×™×ª ××©×¤×˜",image_labeling:"×ª×™×•×’ ×ª××•× ×”",table_completion:"×”×©×œ××ª ×˜×‘×œ×”",text_selection:"×‘×—×™×¨×” ××˜×§×¡×˜",rating_scale:"×¡×§××œ×ª ×“×™×¨×•×’",matrix:"××˜×¨×™×§×¡"})[t]||t,re=async(t,a,i,d,l)=>{const o=(a.activityBlocks||[]).filter(h=>i.includes(h.id));if(o.length===0)throw new Error("×œ× × ×‘×—×¨×• ×‘×œ×•×§×™× ×œ×©×œ×™×—×”");const c=w(),u=w(),m={teacherId:t.teacherId,title:d||`×¤×¢×™×œ×•×ª: ${a.title}`,targetAudience:t.targetAudience,gradeLevel:t.gradeLevel,subject:t.subject,mode:"learning",syllabus:[{id:c,title:a.title,learningUnits:[{id:u,title:a.title,goals:a.goals,type:"practice",baseContent:"",activityBlocks:o.map(h=>({...h,id:`${h.id}-${w().slice(0,8)}`}))}]}],createdAt:_(),updatedAt:_()};m.productType="activity",m.shareableLink=!0,m.parentLesson={courseId:t.id,unitId:a.id,title:t.title,extractedBlockIds:i,extractedAt:new Date().toISOString()};const f=U(C,"courses",t.id),[b,g]=await Promise.all([W(Y(C,"courses"),m),K(f)]),r=b.id;if(g.exists()){const h=g.data().extractedActivities||[];await G(f,{extractedActivities:[...h,{activityCourseId:r,blockIds:i,title:m.title,createdAt:new Date().toISOString()}],updatedAt:_()})}const v=`${window.location.origin}/?studentCourseId=${r}`;return{activityCourseId:r,shareUrl:v}},oe=t=>{const a=[];let i={sectionTitle:"×›×œ×œ×™",blocks:[]};return t.forEach(d=>{if(d.type==="text"){const l=d.content;let o=null;if(typeof l=="string"){const c=l.match(/<h3[^>]*>(.*?)<\/h3>/i);if(c&&(o=c[1].replace(/<[^>]+>/g,"").trim()),!o){const u=l.match(/^#+\s*(.+)/m);u&&(o=u[1].trim())}}o&&(i.blocks.length>0&&a.push(i),i={sectionTitle:o,blocks:[]})}T(d)&&i.blocks.push(d)}),i.blocks.length>0&&a.push(i),a},ce={"multiple-choice":"ğŸ“","open-question":"âœï¸",fill_in_blanks:"ğŸ“‹",ordering:"ğŸ”¢",categorization:"ğŸ“Š",memory_game:"ğŸ§ ",true_false_speed:"âš¡",drag_and_drop:"ğŸ¯",hotspot:"ğŸ“",matching:"ğŸ”—","audio-response":"ğŸ¤","interactive-chat":"ğŸ’¬"},he=({unit:t,course:a,onClose:i,onSuccess:d})=>{const[l,o]=x.useState(new Set),[c,u]=x.useState(`×¤×¢×™×œ×•×ª: ${t.title}`),[m,f]=x.useState("select"),[b,g]=x.useState(!1),[r,v]=x.useState(null),[h,E]=x.useState(null),[j,S]=x.useState(!1),y=x.useMemo(()=>le(t),[t]),I=x.useMemo(()=>oe(t.activityBlocks||[]),[t]),M=s=>{const n=new Set(l);n.has(s)?n.delete(s):n.add(s),o(n)},L=()=>{o(new Set(y.map(s=>s.id)))},z=()=>{o(new Set)},R=s=>{const n=s.content;if(typeof n=="string")return n.substring(0,100)+(n.length>100?"...":"");if(typeof n=="object"&&n!==null){if("question"in n)return n.question;if("instruction"in n)return n.instruction}return B(s.type)},D=async()=>{if(l.size!==0){g(!0);try{const s=await re(a,t,Array.from(l),c);E(s.activityCourseId),v(s.shareUrl),f("share"),d==null||d(s.activityCourseId,s.shareUrl)}catch(s){console.error("Error extracting activity:",s),alert("×©×’×™××” ×‘×™×¦×™×¨×ª ×”×¤×¢×™×œ×•×ª")}finally{g(!1)}}},O=async()=>{if(r)try{await navigator.clipboard.writeText(r),S(!0),setTimeout(()=>S(!1),2e3)}catch(s){console.error("Failed to copy:",s)}},q=()=>{if(!r)return;const s=encodeURIComponent(`${c}

×œ×—×¦×• ×¢×œ ×”×§×™×©×•×¨ ×œ×”×ª×—×™×œ:
${r}`);window.open(`https://wa.me/?text=${s}`,"_blank")},P=()=>{if(!r)return;const s=encodeURIComponent(c),n=encodeURIComponent(`×©×œ×•×,

××¦×•×¨×£ ×§×™×©×•×¨ ×œ×¤×¢×™×œ×•×ª "${c}":
${r}

×‘×”×¦×œ×—×”!`);window.open(`mailto:?subject=${s}&body=${n}`)},F=async()=>{if(!(!r||!navigator.share))try{await navigator.share({title:c,text:`×œ×—×¦×• ×œ×”×ª×—×™×œ ××ª ×”×¤×¢×™×œ×•×ª: ${c}`,url:r})}catch(s){console.error("Share failed:",s)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4",dir:"rtl",children:e.jsxs("div",{className:"bg-white rounded-2xl max-w-2xl w-full max-h-[90vh] overflow-hidden shadow-2xl flex flex-col",children:[e.jsx("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6 shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold mb-1 flex items-center gap-2",children:[e.jsx(A,{className:"w-6 h-6"}),m==="select"?"×©×œ×™×—×ª ×¤×¢×™×œ×•×™×•×ª ×œ×ª×œ××™×“×™×":"×©×™×ª×•×£ ×”×¤×¢×™×œ×•×ª"]}),e.jsx("p",{className:"text-white/80 text-sm",children:m==="select"?"×‘×—×¨×• ××ª ×”×¤×¢×™×œ×•×™×•×ª ×©×‘×¨×¦×•× ×›× ×œ×©×œ×•×— ×œ×ª×œ××™×“×™×":"×”×¤×¢×™×œ×•×ª × ×•×¦×¨×” ×‘×”×¦×œ×—×”! ×©×ª×¤×• ××ª ×”×§×™×©×•×¨ ×¢× ×”×ª×œ××™×“×™×"})]}),e.jsx("button",{onClick:i,className:"p-2 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(V,{className:"w-6 h-6"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:m==="select"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"×©× ×”×¤×¢×™×œ×•×ª"}),e.jsx("input",{type:"text",value:c,onChange:s=>u(s.target.value),className:"w-full px-4 py-3 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all",placeholder:"×”×§×œ×™×“×• ×©× ×œ×¤×¢×™×œ×•×ª..."})]}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:"text-sm text-slate-500",children:["× ×‘×—×¨×• ",l.size," ××ª×•×š ",y.length," ×¤×¢×™×œ×•×™×•×ª"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:L,className:"text-sm text-indigo-600 hover:text-indigo-800 font-medium",children:"×‘×—×¨ ×”×›×œ"}),e.jsx("span",{className:"text-slate-300",children:"|"}),e.jsx("button",{onClick:z,className:"text-sm text-slate-500 hover:text-slate-700 font-medium",children:"× ×§×” ×‘×—×™×¨×”"})]})]}),y.length===0?e.jsxs("div",{className:"text-center py-12 text-slate-400",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"font-medium",children:"××™×Ÿ ×¤×¢×™×œ×•×™×•×ª ××™× ×˜×¨××§×˜×™×‘×™×•×ª ×‘××¢×¨×š ×”×©×™×¢×•×¨"}),e.jsx("p",{className:"text-sm mt-1",children:"×”×•×¡×™×¤×• ×©××œ×•×ª ××• ××©×—×§×™× ×œ××¢×¨×š ×”×©×™×¢×•×¨"})]}):e.jsx("div",{className:"space-y-3",children:I.map((s,n)=>e.jsxs("div",{className:"mb-4",children:[I.length>1&&e.jsxs("h4",{className:"text-sm font-bold text-slate-500 mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full"}),s.sectionTitle]}),s.blocks.map(p=>{const N=l.has(p.id);return e.jsx("div",{onClick:()=>M(p.id),className:`p-4 rounded-xl border-2 cursor-pointer transition-all mb-2 ${N?"border-indigo-500 bg-indigo-50":"border-slate-200 hover:border-slate-300 bg-white"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg border-2 flex items-center justify-center shrink-0 mt-0.5 transition-all ${N?"bg-indigo-500 border-indigo-500":"border-slate-300"}`,children:N&&e.jsx(k,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"text-2xl",children:ce[p.type]||"ğŸ“„"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-xs px-2 py-0.5 bg-slate-100 text-slate-600 rounded-full font-medium",children:B(p.type)})}),e.jsx("p",{className:"text-slate-700 text-sm line-clamp-2",children:R(p)})]})]})},p.id)})]},n))})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(k,{className:"w-8 h-8 text-emerald-600"})}),e.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"×”×¤×¢×™×œ×•×ª × ×•×¦×¨×” ×‘×”×¦×œ×—×”!"}),e.jsxs("p",{className:"text-slate-500 mb-2",children:[l.size," ×¤×¢×™×œ×•×™×•×ª ××•×›× ×•×ª ×œ×©×œ×™×—×” ×œ×ª×œ××™×“×™×"]}),e.jsx("p",{className:"text-sm text-indigo-600 font-medium mb-6",children:"×”×¤×¢×™×œ×•×ª × ×©××¨×” ×•×ª×•×¤×™×¢ ×‘×œ×•×— ×”××•×¨×” ×©×œ×š"}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-4 mb-6 text-right",children:[e.jsx("label",{className:"block text-sm font-bold text-slate-700 mb-2",children:"×§×™×©×•×¨ ×œ×©×œ×™×—×” ×œ×ª×œ××™×“×™×:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:r||"",readOnly:!0,className:"flex-1 px-4 py-3 bg-white border border-slate-200 rounded-xl text-sm font-mono text-slate-700 text-left",dir:"ltr"}),e.jsxs("button",{onClick:O,className:`p-3 rounded-xl transition-all flex items-center gap-2 font-bold ${j?"bg-emerald-500 text-white":"bg-indigo-600 text-white hover:bg-indigo-700"}`,children:[j?e.jsx(k,{className:"w-5 h-5"}):e.jsx(J,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden sm:inline",children:j?"×”×•×¢×ª×§!":"×”×¢×ª×§"})]})]}),j&&e.jsx("p",{className:"text-emerald-600 text-sm mt-2 font-medium",children:"×”×§×™×©×•×¨ ×”×•×¢×ª×§! ×©×œ×—×• ××•×ª×• ×œ×ª×œ××™×“×™× ×‘×›×œ ×“×¨×š ×©× ×•×—×” ×œ×›×"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:q,className:"flex flex-col items-center gap-2 p-4 bg-emerald-50 hover:bg-emerald-100 rounded-xl transition-colors",children:[e.jsx(ee,{className:"w-8 h-8 text-emerald-600"}),e.jsx("span",{className:"text-sm font-medium text-emerald-700",children:"WhatsApp"})]}),e.jsxs("button",{onClick:P,className:"flex flex-col items-center gap-2 p-4 bg-blue-50 hover:bg-blue-100 rounded-xl transition-colors",children:[e.jsx(Q,{className:"w-8 h-8 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-700",children:"××™××™×™×œ"})]}),navigator.share&&e.jsxs("button",{onClick:F,className:"flex flex-col items-center gap-2 p-4 bg-purple-50 hover:bg-purple-100 rounded-xl transition-colors",children:[e.jsx(se,{className:"w-8 h-8 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-700",children:"×©×™×ª×•×£"})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-indigo-50 rounded-xl text-right",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(X,{className:"w-5 h-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-indigo-800 font-medium",children:"×ª×•×¦××•×ª ×”×ª×œ××™×“×™× ×™×•×¤×™×¢×• ×‘×œ×•×— ×”×‘×§×¨×”"}),e.jsx("p",{className:"text-xs text-indigo-600 mt-1",children:"×ª×•×›×œ×• ×œ×¢×§×•×‘ ××—×¨×™ ×”×”×ª×§×“××•×ª ×•×”×¦×™×•× ×™× ×‘×–××Ÿ ×××ª"})]})]})})]})}),e.jsx("div",{className:"p-6 bg-slate-50 border-t border-slate-200 shrink-0",children:m==="select"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:i,className:"px-6 py-3 text-slate-600 hover:text-slate-800 font-medium transition-colors",children:"×‘×™×˜×•×œ"}),e.jsx("button",{onClick:D,disabled:l.size===0||b,className:"px-8 py-3 bg-indigo-600 text-white rounded-xl font-bold hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"×™×•×¦×¨ ×¤×¢×™×œ×•×ª..."]}):e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"w-5 h-5"}),"×¦×•×¨ ×¤×¢×™×œ×•×ª ×œ×ª×œ××™×“×™× (",l.size,")"]})})]}):e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:i,className:"px-8 py-3 bg-slate-200 text-slate-700 rounded-xl font-bold hover:bg-slate-300 transition-colors",children:"×¡×’×•×¨"})})})]})})};export{he as default};
//# sourceMappingURL=SendActivitiesModal-B0HEUCEv.js.map
