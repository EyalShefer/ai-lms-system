{"version":3,"file":"KnowledgeBaseAdmin-t8HBLg16.js","sources":["../../src/components/referenceExams/ExamDnaViewer.tsx","../../src/components/referenceExams/ReferenceExamUpload.tsx","../../src/components/referenceExams/ReferenceExamsList.tsx","../../src/components/KnowledgeBaseAdmin.tsx"],"sourcesContent":["// ExamDnaViewer.tsx - Visualization of extracted Exam DNA\n\nimport React from 'react';\n\ninterface ExamDNA {\n  questionCount: number;\n  totalPoints: number;\n  estimatedDurationMinutes: number;\n  questionTypeDistribution: Record<string, number>;\n  bloomDistribution: Record<string, number>;\n  difficultyDistribution: Record<string, number>;\n  linguisticStyle: {\n    averageQuestionLengthWords: number;\n    usesRealWorldContext: boolean;\n    usesVisualElements: boolean;\n    formalityLevel: string;\n  };\n  extractionConfidence: number;\n}\n\ninterface ExamDnaViewerProps {\n  dna: ExamDNA;\n  compact?: boolean;\n}\n\nconst QUESTION_TYPE_LABELS: Record<string, string> = {\n  multiple_choice: '×¨×‘-×‘×¨×™×¨×”',\n  true_false: '× ×›×•×Ÿ/×œ× × ×›×•×Ÿ',\n  open_question: '×©××œ×” ×¤×ª×•×—×”',\n  fill_in_blanks: '×”×©×œ××”',\n  ordering: '×¡×™×“×•×¨',\n  categorization: '××™×•×Ÿ',\n};\n\nconst BLOOM_LABELS: Record<string, string> = {\n  remember: '×–×›×™×¨×”',\n  understand: '×”×‘× ×”',\n  apply: '×™×™×©×•×',\n  analyze: '× ×™×ª×•×—',\n  evaluate: '×”×¢×¨×›×”',\n  create: '×™×¦×™×¨×”',\n};\n\nconst DIFFICULTY_LABELS: Record<string, string> = {\n  easy: '×§×œ',\n  medium: '×‘×™× ×•× ×™',\n  hard: '×§×©×”',\n};\n\nconst FORMALITY_LABELS: Record<string, string> = {\n  low: '×œ× ×¤×•×¨××œ×™',\n  medium: '×‘×™× ×•× ×™',\n  high: '×¤×•×¨××œ×™',\n};\n\n// Simple bar component for distribution visualization\nfunction DistributionBar({\n  label,\n  percentage,\n  color,\n}: {\n  label: string;\n  percentage: number;\n  color: string;\n}) {\n  if (percentage === 0) return null;\n\n  return (\n    <div className=\"flex items-center gap-2 mb-1\">\n      <span className=\"text-sm text-gray-600 w-20 text-right\">{label}</span>\n      <div className=\"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden\">\n        <div\n          className={`h-full ${color} transition-all duration-300`}\n          style={{ width: `${percentage}%` }}\n        />\n      </div>\n      <span className=\"text-sm text-gray-700 w-10\">{percentage}%</span>\n    </div>\n  );\n}\n\nexport default function ExamDnaViewer({ dna, compact = false }: ExamDnaViewerProps) {\n  const confidenceColor =\n    dna.extractionConfidence >= 0.8\n      ? 'text-green-600'\n      : dna.extractionConfidence >= 0.6\n      ? 'text-yellow-600'\n      : 'text-red-600';\n\n  if (compact) {\n    // Compact view for lists\n    return (\n      <div className=\"flex items-center gap-4 text-sm text-gray-600\">\n        <span>{dna.questionCount} ×©××œ×•×ª</span>\n        <span>{dna.totalPoints} × ×§×•×“×•×ª</span>\n        <span>~{dna.estimatedDurationMinutes} ×“×§×•×ª</span>\n        <span className={confidenceColor}>\n          ×¨××ª ×‘×™×˜×—×•×Ÿ: {Math.round(dna.extractionConfidence * 100)}%\n        </span>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Summary */}\n      <div className=\"grid grid-cols-3 gap-4 bg-gray-50 rounded-lg p-4\">\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-blue-600\">{dna.questionCount}</p>\n          <p className=\"text-sm text-gray-600\">×©××œ×•×ª</p>\n        </div>\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-green-600\">{dna.totalPoints}</p>\n          <p className=\"text-sm text-gray-600\">× ×§×•×“×•×ª</p>\n        </div>\n        <div className=\"text-center\">\n          <p className=\"text-2xl font-bold text-purple-600\">~{dna.estimatedDurationMinutes}</p>\n          <p className=\"text-sm text-gray-600\">×“×§×•×ª</p>\n        </div>\n      </div>\n\n      {/* Confidence */}\n      <div className=\"flex items-center justify-between bg-gray-50 rounded-lg p-3\">\n        <span className=\"text-sm text-gray-600\">×¨××ª ×‘×™×˜×—×•×Ÿ ×‘×—×™×œ×•×¥:</span>\n        <span className={`font-semibold ${confidenceColor}`}>\n          {Math.round(dna.extractionConfidence * 100)}%\n        </span>\n      </div>\n\n      {/* Question Type Distribution */}\n      <div>\n        <h4 className=\"font-medium text-gray-800 mb-3\">×”×ª×¤×œ×’×•×ª ×¡×•×’×™ ×©××œ×•×ª</h4>\n        <div className=\"bg-gray-50 rounded-lg p-4\">\n          {Object.entries(dna.questionTypeDistribution)\n            .filter(([_, pct]) => pct > 0)\n            .map(([type, pct]) => (\n              <DistributionBar\n                key={type}\n                label={QUESTION_TYPE_LABELS[type] || type}\n                percentage={pct}\n                color=\"bg-blue-500\"\n              />\n            ))}\n        </div>\n      </div>\n\n      {/* Bloom Distribution */}\n      <div>\n        <h4 className=\"font-medium text-gray-800 mb-3\">×”×ª×¤×œ×’×•×ª ×¨××•×ª ×‘×œ×•×</h4>\n        <div className=\"bg-gray-50 rounded-lg p-4\">\n          {Object.entries(dna.bloomDistribution)\n            .filter(([_, pct]) => pct > 0)\n            .map(([level, pct]) => (\n              <DistributionBar\n                key={level}\n                label={BLOOM_LABELS[level] || level}\n                percentage={pct}\n                color=\"bg-green-500\"\n              />\n            ))}\n        </div>\n      </div>\n\n      {/* Difficulty Distribution */}\n      <div>\n        <h4 className=\"font-medium text-gray-800 mb-3\">×”×ª×¤×œ×’×•×ª ×¨××•×ª ×§×•×©×™</h4>\n        <div className=\"bg-gray-50 rounded-lg p-4\">\n          {Object.entries(dna.difficultyDistribution)\n            .filter(([_, pct]) => pct > 0)\n            .map(([level, pct]) => (\n              <DistributionBar\n                key={level}\n                label={DIFFICULTY_LABELS[level] || level}\n                percentage={pct}\n                color={\n                  level === 'easy' ? 'bg-green-400' : level === 'medium' ? 'bg-yellow-400' : 'bg-red-400'\n                }\n              />\n            ))}\n        </div>\n      </div>\n\n      {/* Linguistic Style */}\n      <div>\n        <h4 className=\"font-medium text-gray-800 mb-3\">×¡×’× ×•×Ÿ ×œ×©×•× ×™</h4>\n        <div className=\"bg-gray-50 rounded-lg p-4 grid grid-cols-2 gap-4\">\n          <div>\n            <p className=\"text-sm text-gray-500\">××•×¨×š ×©××œ×” ×××•×¦×¢</p>\n            <p className=\"font-medium\">{dna.linguisticStyle.averageQuestionLengthWords} ××™×œ×™×</p>\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">×¨××ª ×¤×•×¨××œ×™×•×ª</p>\n            <p className=\"font-medium\">\n              {FORMALITY_LABELS[dna.linguisticStyle.formalityLevel] || dna.linguisticStyle.formalityLevel}\n            </p>\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">×”×§×©×¨ ×™×•××™×•××™</p>\n            <p className=\"font-medium\">{dna.linguisticStyle.usesRealWorldContext ? '×›×Ÿ' : '×œ×'}</p>\n          </div>\n          <div>\n            <p className=\"text-sm text-gray-500\">××œ×× ×˜×™× ×•×™×–×•××œ×™×™×</p>\n            <p className=\"font-medium\">{dna.linguisticStyle.usesVisualElements ? '×›×Ÿ' : '×œ×'}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","// ReferenceExamUpload.tsx - Upload form for reference exams\n\nimport React, { useState, useEffect } from 'react';\nimport { httpsCallable } from 'firebase/functions';\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\nimport { functions, storage } from '../../firebase';\nimport { useAuth } from '../../context/AuthContext';\nimport ExamDnaViewer from './ExamDnaViewer';\n\ninterface TextbookOption {\n  id: string;\n  name: string;\n  grade: string;\n  subject: string;\n  volume?: number;\n}\n\ninterface ExamDNA {\n  questionCount: number;\n  totalPoints: number;\n  estimatedDurationMinutes: number;\n  questionTypeDistribution: Record<string, number>;\n  bloomDistribution: Record<string, number>;\n  difficultyDistribution: Record<string, number>;\n  linguisticStyle: {\n    averageQuestionLengthWords: number;\n    usesRealWorldContext: boolean;\n    usesVisualElements: boolean;\n    formalityLevel: string;\n  };\n  extractionConfidence: number;\n}\n\ninterface UploadResponse {\n  success: boolean;\n  examId: string;\n  examDna: ExamDNA | null;\n  linkedTextbookName: string;\n  processingTimeMs: number;\n  errors?: string[];\n}\n\nconst EXAM_TYPES = [\n  { value: 'unit_exam', label: '××‘×—×Ÿ ×™×—×™×“×” / ×¡×™×›×•× ×¤×¨×§' },\n  { value: 'midterm', label: '××‘×—×Ÿ ×××¦×¢' },\n  { value: 'final', label: '××‘×—×Ÿ ××¡×›×' },\n  { value: 'quiz', label: '×‘×•×—×Ÿ ×§×¦×¨' },\n];\n\nconst GRADES = ['×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜', '×™', '×™×', '×™×‘'];\n\nconst VOLUMES = [1, 2, 3, 4, 5];\n\nconst SUBJECTS = [\n  { value: 'math', label: '××ª××˜×™×§×”' },\n  { value: 'hebrew', label: '×¢×‘×¨×™×ª' },\n  { value: 'english', label: '×× ×’×œ×™×ª' },\n  { value: 'science', label: '××“×¢×™×' },\n  { value: 'history', label: '×”×™×¡×˜×•×¨×™×”' },\n  { value: 'other', label: '××—×¨' },\n];\n\ninterface ReferenceExamUploadProps {\n  onUploadComplete?: (result: UploadResponse) => void;\n}\n\nexport default function ReferenceExamUpload({ onUploadComplete }: ReferenceExamUploadProps) {\n  const { currentUser } = useAuth();\n\n  // File state\n  const [file, setFile] = useState<File | null>(null);\n\n  // Metadata state\n  const [subject, setSubject] = useState('math');\n  const [grade, setGrade] = useState('×‘');\n  const [volume, setVolume] = useState<number>(1);\n  const [selectedTextbook, setSelectedTextbook] = useState('');\n  const [selectedChapters, setSelectedChapters] = useState<number[]>([]);\n  const [examType, setExamType] = useState('unit_exam');\n  const [source, setSource] = useState('');\n  const [year, setYear] = useState<number | ''>('');\n\n  // Available textbooks\n  const [textbooks, setTextbooks] = useState<TextbookOption[]>([]);\n  const [loadingTextbooks, setLoadingTextbooks] = useState(false);\n\n  // Upload state\n  const [uploading, setUploading] = useState(false);\n  const [uploadProgress, setUploadProgress] = useState('');\n  const [uploadResult, setUploadResult] = useState<UploadResponse | null>(null);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load available textbooks on mount and when grade/subject/volume changes\n  useEffect(() => {\n    loadTextbooks();\n  }, [grade, subject, volume]);\n\n  const loadTextbooks = async () => {\n    setLoadingTextbooks(true);\n    try {\n      const getAvailableTextbooks = httpsCallable(functions, 'getAvailableTextbooks');\n      const result = await getAvailableTextbooks({});\n      const data = result.data as { textbooks: TextbookOption[] };\n\n      // Filter by current grade, subject, and volume\n      const filtered = data.textbooks.filter(\n        (t) => t.grade === grade && t.subject === subject && (t.volume === volume || t.id.includes(`_${volume}_`))\n      );\n      setTextbooks(filtered);\n\n      // Auto-select first if available\n      if (filtered.length > 0 && !selectedTextbook) {\n        setSelectedTextbook(filtered[0].id);\n      }\n    } catch (err) {\n      console.error('Failed to load textbooks:', err);\n    } finally {\n      setLoadingTextbooks(false);\n    }\n  };\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const selectedFile = e.target.files?.[0];\n    if (selectedFile) {\n      if (selectedFile.type !== 'application/pdf') {\n        setError('×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥ PDF ×‘×œ×‘×“');\n        return;\n      }\n      setFile(selectedFile);\n      setError(null);\n      setUploadResult(null);\n    }\n  };\n\n  const handleChapterToggle = (chapter: number) => {\n    setSelectedChapters((prev) =>\n      prev.includes(chapter) ? prev.filter((c) => c !== chapter) : [...prev, chapter].sort((a, b) => a - b)\n    );\n  };\n\n  const handleUpload = async () => {\n    if (!file) {\n      setError('×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥');\n      return;\n    }\n    if (!selectedTextbook) {\n      setError('×™×© ×œ×‘×—×•×¨ ×¡×¤×¨ ×œ×™××•×“');\n      return;\n    }\n    if (selectedChapters.length === 0) {\n      setError('×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×¤×¨×§ ××—×“');\n      return;\n    }\n\n    setUploading(true);\n    setError(null);\n    setUploadProgress('××¢×œ×” ×§×•×‘×¥...');\n\n    try {\n      // 1. Upload file to Firebase Storage\n      const timestamp = Date.now();\n      const storagePath = `reference-exams/${currentUser?.uid}/${timestamp}_${file.name}`;\n      const storageRef = ref(storage, storagePath);\n\n      await uploadBytes(storageRef, file);\n      const fileUrl = await getDownloadURL(storageRef);\n\n      setUploadProgress('××—×œ×¥ DNA ××”××‘×—×Ÿ...');\n\n      // 2. Call Cloud Function to process\n      const uploadReferenceExam = httpsCallable(functions, 'uploadReferenceExam');\n      const result = await uploadReferenceExam({\n        fileUrl,\n        storagePath,\n        mimeType: 'application/pdf',\n        fileName: file.name,\n        subject,\n        grade,\n        linkedTextbookId: selectedTextbook,\n        chapters: selectedChapters,\n        examType,\n        source: source || undefined,\n        year: year || undefined,\n      });\n\n      const response = result.data as UploadResponse;\n      setUploadResult(response);\n      setUploadProgress('');\n\n      if (response.success) {\n        // Reset form\n        setFile(null);\n        setSelectedChapters([]);\n        setSource('');\n        setYear('');\n\n        if (onUploadComplete) {\n          onUploadComplete(response);\n        }\n      } else {\n        setError(response.errors?.join(', ') || '×©×’×™××” ×‘×”×¢×œ××”');\n      }\n    } catch (err: any) {\n      console.error('Upload failed:', err);\n      setError(err.message || '×©×’×™××” ×‘×”×¢×œ××ª ×”×§×•×‘×¥');\n      setUploadProgress('');\n    } finally {\n      setUploading(false);\n    }\n  };\n\n  return (\n    <div className=\"bg-white rounded-lg shadow p-6\">\n      <h2 className=\"text-xl font-semibold mb-4\">×”×¢×œ××ª ××‘×—×Ÿ ×™×™×—×•×¡</h2>\n      <p className=\"text-gray-600 text-sm mb-6\">\n        ×”×¢×œ×” ××‘×—×Ÿ ×§×™×™× (××”××“×¨×™×š ×œ××•×¨×” ××• ×××©×¨×“ ×”×—×™× ×•×š) ×•×”××¢×¨×›×ª ×ª×—×œ×¥ ××ª ×”-DNA ×©×œ×• - ××‘× ×”, ×¡×•×’×™ ×©××œ×•×ª, ×¨××•×ª ×§×•×©×™.\n        ×‘×”××©×š, ×”××¢×¨×›×ª ×ª×©×ª××© ×‘-DNA ×”×–×” ×›×ª×‘× ×™×ª ×œ×™×¦×™×¨×ª ××‘×—× ×™× ×—×“×©×™×.\n      </p>\n\n      <div className=\"space-y-4\">\n        {/* File Input */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">×§×•×‘×¥ PDF ×©×œ ×”××‘×—×Ÿ</label>\n          <input\n            type=\"file\"\n            accept=\".pdf\"\n            onChange={handleFileChange}\n            className=\"block w-full text-sm text-gray-500\n              file:mr-4 file:py-2 file:px-4\n              file:rounded-md file:border-0\n              file:text-sm file:font-semibold\n              file:bg-blue-50 file:text-blue-700\n              hover:file:bg-blue-100\"\n          />\n          {file && (\n            <p className=\"mt-1 text-sm text-gray-500\">\n              × ×‘×—×¨: {file.name} ({(file.size / 1024 / 1024).toFixed(2)} MB)\n            </p>\n          )}\n        </div>\n\n        {/* Subject, Grade, and Volume */}\n        <div className=\"grid grid-cols-3 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">××§×¦×•×¢</label>\n            <select\n              value={subject}\n              onChange={(e) => {\n                setSubject(e.target.value);\n                setSelectedTextbook('');\n              }}\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            >\n              {SUBJECTS.map((s) => (\n                <option key={s.value} value={s.value}>\n                  {s.label}\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">×›×™×ª×”</label>\n            <select\n              value={grade}\n              onChange={(e) => {\n                setGrade(e.target.value);\n                setSelectedTextbook('');\n              }}\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            >\n              {GRADES.map((g) => (\n                <option key={g} value={g}>\n                  ×›×™×ª×” {g}×³\n                </option>\n              ))}\n            </select>\n          </div>\n\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">×›×¨×š / ×¡×¤×¨</label>\n            <select\n              value={volume}\n              onChange={(e) => {\n                setVolume(parseInt(e.target.value));\n                setSelectedTextbook('');\n              }}\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            >\n              {VOLUMES.map((v) => (\n                <option key={v} value={v}>\n                  ×¡×¤×¨ {v}\n                </option>\n              ))}\n            </select>\n          </div>\n        </div>\n\n        {/* Textbook Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">×©×™×•×š ×œ×¡×¤×¨ ×œ×™××•×“</label>\n          {loadingTextbooks ? (\n            <p className=\"text-gray-500 text-sm\">×˜×•×¢×Ÿ ×¡×¤×¨×™×...</p>\n          ) : textbooks.length === 0 ? (\n            <p className=\"text-orange-600 text-sm\">\n              ×œ× × ××¦××• ×¡×¤×¨×™× ×œ×›×™×ª×” {grade}×³ ×‘××§×¦×•×¢ {SUBJECTS.find((s) => s.value === subject)?.label}, ×¡×¤×¨ {volume}.\n              ×™×© ×œ×”×¢×œ×•×ª ×¡×¤×¨ ×œ×™××•×“ ×§×•×“×.\n            </p>\n          ) : (\n            <select\n              value={selectedTextbook}\n              onChange={(e) => setSelectedTextbook(e.target.value)}\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            >\n              <option value=\"\">×‘×—×¨ ×¡×¤×¨...</option>\n              {textbooks.map((t) => (\n                <option key={t.id} value={t.id}>\n                  {t.name}\n                </option>\n              ))}\n            </select>\n          )}\n        </div>\n\n        {/* Chapters Selection */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">×¤×¨×§×™× ×©×”××‘×—×Ÿ ××›×¡×”</label>\n          <div className=\"flex flex-wrap gap-2\">\n            {[1, 2, 3, 4, 5, 6, 7, 8, 9, 10].map((ch) => (\n              <button\n                key={ch}\n                type=\"button\"\n                onClick={() => handleChapterToggle(ch)}\n                className={`px-3 py-1 rounded-full text-sm ${\n                  selectedChapters.includes(ch)\n                    ? 'bg-blue-600 text-white'\n                    : 'bg-gray-100 text-gray-700 hover:bg-gray-200'\n                }`}\n              >\n                ×¤×¨×§ {ch}\n              </button>\n            ))}\n          </div>\n          {selectedChapters.length > 0 && (\n            <p className=\"mt-1 text-sm text-gray-500\">× ×‘×—×¨×•: ×¤×¨×§×™× {selectedChapters.join(', ')}</p>\n          )}\n        </div>\n\n        {/* Exam Type */}\n        <div>\n          <label className=\"block text-sm font-medium text-gray-700 mb-1\">×¡×•×’ ×”××‘×—×Ÿ</label>\n          <select\n            value={examType}\n            onChange={(e) => setExamType(e.target.value)}\n            className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n          >\n            {EXAM_TYPES.map((t) => (\n              <option key={t.value} value={t.value}>\n                {t.label}\n              </option>\n            ))}\n          </select>\n        </div>\n\n        {/* Optional: Source and Year */}\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">××§×•×¨ (××•×¤×¦×™×•× ×œ×™)</label>\n            <input\n              type=\"text\"\n              value={source}\n              onChange={(e) => setSource(e.target.value)}\n              placeholder=\"××“×¨×™×š ×œ××•×¨×”, ××©×¨×“ ×”×—×™× ×•×š...\"\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            />\n          </div>\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-1\">×©× ×” (××•×¤×¦×™×•× ×œ×™)</label>\n            <input\n              type=\"number\"\n              value={year}\n              onChange={(e) => setYear(e.target.value ? parseInt(e.target.value) : '')}\n              placeholder=\"2024\"\n              min={2000}\n              max={2030}\n              className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\n            />\n          </div>\n        </div>\n\n        {/* Error */}\n        {error && (\n          <div className=\"bg-red-50 border border-red-200 rounded-md p-3\">\n            <p className=\"text-red-700 text-sm\">{error}</p>\n          </div>\n        )}\n\n        {/* Upload Progress */}\n        {uploadProgress && (\n          <div className=\"bg-blue-50 border border-blue-200 rounded-md p-3\">\n            <p className=\"text-blue-700 text-sm\">{uploadProgress}</p>\n          </div>\n        )}\n\n        {/* Upload Button */}\n        <button\n          onClick={handleUpload}\n          disabled={uploading || !file || !selectedTextbook || selectedChapters.length === 0}\n          className=\"w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700\n            disabled:opacity-50 disabled:cursor-not-allowed\"\n        >\n          {uploading ? '××¢×‘×“...' : '×”×¢×œ×” ×•×—×œ×¥ DNA'}\n        </button>\n\n        {/* Upload Result */}\n        {uploadResult?.success && uploadResult.examDna && (\n          <div className=\"mt-6 border-t pt-6\">\n            <h3 className=\"text-lg font-semibold mb-4 text-green-700\">DNA ×—×•×œ×¥ ×‘×”×¦×œ×—×”!</h3>\n            <ExamDnaViewer dna={uploadResult.examDna} />\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","// ReferenceExamsList.tsx - List of uploaded reference exams\n\nimport React, { useState, useEffect } from 'react';\nimport { httpsCallable } from 'firebase/functions';\nimport { functions } from '../../firebase';\nimport ExamDnaViewer from './ExamDnaViewer';\n\ninterface ExamDNA {\n  questionCount: number;\n  totalPoints: number;\n  estimatedDurationMinutes: number;\n  questionTypeDistribution: Record<string, number>;\n  bloomDistribution: Record<string, number>;\n  difficultyDistribution: Record<string, number>;\n  linguisticStyle: {\n    averageQuestionLengthWords: number;\n    usesRealWorldContext: boolean;\n    usesVisualElements: boolean;\n    formalityLevel: string;\n  };\n  extractionConfidence: number;\n}\n\ninterface ReferenceExam {\n  id: string;\n  documentType: 'reference_exam';\n  linkedTextbookId: string;\n  linkedTextbookName: string;\n  chapters: number[];\n  subject: string;\n  grade: string;\n  examType: string;\n  fileName: string;\n  examDna: ExamDNA;\n  source?: string;\n  year?: number;\n  uploadedBy: string;\n  uploadedAt: any;\n  usageCount: number;\n}\n\nconst EXAM_TYPE_LABELS: Record<string, string> = {\n  unit_exam: '××‘×—×Ÿ ×™×—×™×“×”',\n  midterm: '××‘×—×Ÿ ×××¦×¢',\n  final: '××‘×—×Ÿ ××¡×›×',\n  quiz: '×‘×•×—×Ÿ',\n};\n\nexport default function ReferenceExamsList() {\n  const [exams, setExams] = useState<ReferenceExam[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const [expandedExam, setExpandedExam] = useState<string | null>(null);\n  const [deletingExam, setDeletingExam] = useState<string | null>(null);\n\n  useEffect(() => {\n    loadExams();\n  }, []);\n\n  const loadExams = async () => {\n    setLoading(true);\n    setError(null);\n    try {\n      const listReferenceExams = httpsCallable(functions, 'listReferenceExams');\n      const result = await listReferenceExams({});\n      const data = result.data as { exams: ReferenceExam[] };\n      setExams(data.exams || []);\n    } catch (err: any) {\n      console.error('Failed to load exams:', err);\n      setError(err.message || '×©×’×™××” ×‘×˜×¢×™× ×ª ××‘×—× ×™×');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const handleDelete = async (examId: string) => {\n    if (!window.confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ××‘×—×Ÿ ×”×™×™×—×•×¡ ×”×–×”?')) {\n      return;\n    }\n\n    setDeletingExam(examId);\n    try {\n      const deleteReferenceExam = httpsCallable(functions, 'deleteReferenceExam');\n      await deleteReferenceExam({ examId });\n      setExams((prev) => prev.filter((e) => e.id !== examId));\n    } catch (err: any) {\n      console.error('Failed to delete exam:', err);\n      alert('×©×’×™××” ×‘××—×™×§×”: ' + err.message);\n    } finally {\n      setDeletingExam(null);\n    }\n  };\n\n  const toggleExpand = (examId: string) => {\n    setExpandedExam((prev) => (prev === examId ? null : examId));\n  };\n\n  if (loading) {\n    return (\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <p className=\"text-gray-500 text-center\">×˜×•×¢×Ÿ ××‘×—× ×™ ×™×™×—×•×¡...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <p className=\"text-red-600 text-center\">{error}</p>\n        <button onClick={loadExams} className=\"mt-4 text-blue-600 hover:underline mx-auto block\">\n          × ×¡×” ×©×•×‘\n        </button>\n      </div>\n    );\n  }\n\n  if (exams.length === 0) {\n    return (\n      <div className=\"bg-white rounded-lg shadow p-6\">\n        <div className=\"text-center text-gray-500\">\n          <p className=\"text-lg mb-2\">××™×Ÿ ×¢×“×™×™×Ÿ ××‘×—× ×™ ×™×™×—×•×¡</p>\n          <p className=\"text-sm\">×”×¢×œ×” ××‘×—×Ÿ ×§×™×™× ×›×“×™ ×œ×™×¦×•×¨ ×ª×‘× ×™×ª ×œ×™×™×¦×•×¨ ××‘×—× ×™× ×—×“×©×™×</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h3 className=\"text-lg font-semibold text-gray-800\">××‘×—× ×™ ×™×™×—×•×¡ ({exams.length})</h3>\n        <button onClick={loadExams} className=\"text-blue-600 hover:underline text-sm\">\n          ×¨×¢× ×Ÿ\n        </button>\n      </div>\n\n      {exams.map((exam) => (\n        <div key={exam.id} className=\"bg-white rounded-lg shadow overflow-hidden\">\n          {/* Header - always visible */}\n          <div\n            className=\"p-4 cursor-pointer hover:bg-gray-50 flex items-center justify-between\"\n            onClick={() => toggleExpand(exam.id)}\n          >\n            <div className=\"flex-1\">\n              <div className=\"flex items-center gap-3\">\n                <h4 className=\"font-medium text-gray-800\">{exam.linkedTextbookName}</h4>\n                <span className=\"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded\">\n                  {EXAM_TYPE_LABELS[exam.examType] || exam.examType}\n                </span>\n              </div>\n              <p className=\"text-sm text-gray-500 mt-1\">\n                ×¤×¨×§×™×: {exam.chapters.join(', ')} | {exam.examDna.questionCount} ×©××œ×•×ª |{' '}\n                {exam.examDna.totalPoints} × ×§×•×“×•×ª\n                {exam.usageCount > 0 && (\n                  <span className=\"text-green-600 mr-2\">({exam.usageCount} ×©×™××•×©×™×)</span>\n                )}\n              </p>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <button\n                onClick={(e) => {\n                  e.stopPropagation();\n                  handleDelete(exam.id);\n                }}\n                disabled={deletingExam === exam.id}\n                className=\"text-red-500 hover:text-red-700 p-1 disabled:opacity-50\"\n                title=\"××—×§\"\n              >\n                {deletingExam === exam.id ? '...' : 'ğŸ—‘ï¸'}\n              </button>\n              <span className=\"text-gray-400\">{expandedExam === exam.id ? 'â–²' : 'â–¼'}</span>\n            </div>\n          </div>\n\n          {/* Expanded content */}\n          {expandedExam === exam.id && (\n            <div className=\"border-t p-4 bg-gray-50\">\n              {/* Metadata */}\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm\">\n                <div>\n                  <span className=\"text-gray-500\">×§×•×‘×¥:</span>\n                  <p className=\"text-gray-800\">{exam.fileName}</p>\n                </div>\n                {exam.source && (\n                  <div>\n                    <span className=\"text-gray-500\">××§×•×¨:</span>\n                    <p className=\"text-gray-800\">{exam.source}</p>\n                  </div>\n                )}\n                {exam.year && (\n                  <div>\n                    <span className=\"text-gray-500\">×©× ×”:</span>\n                    <p className=\"text-gray-800\">{exam.year}</p>\n                  </div>\n                )}\n                <div>\n                  <span className=\"text-gray-500\">×©×™××•×©×™×:</span>\n                  <p className=\"text-gray-800\">{exam.usageCount}</p>\n                </div>\n              </div>\n\n              {/* DNA Visualization */}\n              <ExamDnaViewer dna={exam.examDna} />\n            </div>\n          )}\n        </div>\n      ))}\n    </div>\n  );\n}\n","// KnowledgeBaseAdmin.tsx - Admin interface for managing the math knowledge base\r\n\r\nimport React, { useState, useCallback, useEffect } from 'react';\r\nimport { httpsCallable } from 'firebase/functions';\r\nimport { ref, uploadBytes, getDownloadURL } from 'firebase/storage';\r\nimport { collection, query, where, getDocs, orderBy, limit, doc, onSnapshot } from 'firebase/firestore';\r\nimport { functions, storage, db } from '../firebase';\r\nimport { useAuth } from '../context/AuthContext';\r\nimport { ReferenceExamUpload, ReferenceExamsList } from './referenceExams';\r\n\r\ninterface UploadResponse {\r\n  success: boolean;\r\n  documentId: string;\r\n  chunksCreated: number;\r\n  chaptersFound: string[];\r\n  processingTimeMs: number;\r\n  errors?: string[];\r\n  extractionQuality?: {\r\n    method: string;\r\n    averageConfidence?: number;\r\n    pagesNeedingReview?: number[];\r\n  };\r\n  // For batch processing of large PDFs\r\n  progress?: {\r\n    processedPages: number;\r\n    totalPages: number;\r\n    percentComplete: number;\r\n  };\r\n}\r\n\r\ninterface SearchResult {\r\n  chunk: {\r\n    id: string;\r\n    grade: string;\r\n    volume: number;\r\n    volumeType: 'student' | 'teacher' | 'curriculum';\r\n    chapter: string;\r\n    content: string;\r\n    contentType: string;\r\n    source: string;\r\n    keywords: string[];\r\n  };\r\n  similarity: number;\r\n}\r\n\r\ninterface Stats {\r\n  totalChunks: number;\r\n  byGrade: Record<string, number>;\r\n  bySubject: Record<string, number>;\r\n  byVolumeType: Record<string, number>;\r\n}\r\n\r\nconst GRADES = ['×', '×‘', '×’', '×“', '×”', '×•', '×–', '×—', '×˜', '×™', '×™×', '×™×‘'];\r\nconst SUBJECTS = [\r\n  { value: 'math', label: '××ª××˜×™×§×”' },\r\n  { value: 'hebrew', label: '×¢×‘×¨×™×ª' },\r\n  { value: 'english', label: '×× ×’×œ×™×ª' },\r\n  { value: 'science', label: '××“×¢×™×' },\r\n  { value: 'history', label: '×”×™×¡×˜×•×¨×™×”' },\r\n  { value: 'other', label: '××—×¨' },\r\n];\r\n\r\ninterface KnowledgeBaseAdminProps {\r\n  onNavigateToReview?: () => void;\r\n}\r\n\r\nexport default function KnowledgeBaseAdmin({ onNavigateToReview }: KnowledgeBaseAdminProps) {\r\n  const { currentUser } = useAuth();\r\n\r\n  // Upload state\r\n  const [file, setFile] = useState<File | null>(null);\r\n  const [uploadProgress, setUploadProgress] = useState<string>('');\r\n  const [subject, setSubject] = useState('math');\r\n  const [grade, setGrade] = useState('×‘');\r\n  const [volume, setVolume] = useState(1);\r\n  const [volumeType, setVolumeType] = useState<'student' | 'teacher' | 'curriculum'>('student');\r\n  const [selectedGrades, setSelectedGrades] = useState<string[]>(['×‘']); // For curriculum - multiple grades\r\n  const [uploading, setUploading] = useState(false);\r\n  const [uploadResult, setUploadResult] = useState<UploadResponse | null>(null);\r\n  const [batchProgressId, setBatchProgressId] = useState<string | null>(null);\r\n  const [continuing, setContinuing] = useState(false);\r\n  const [liveProgress, setLiveProgress] = useState<{\r\n    processedPages: number;\r\n    totalPages: number;\r\n    currentPage?: number;\r\n    status?: string;\r\n  } | null>(null);\r\n\r\n  // Search state\r\n  const [searchQuery, setSearchQuery] = useState('');\r\n  const [searchGrade, setSearchGrade] = useState('');\r\n  const [searchVolumeType, setSearchVolumeType] = useState('');\r\n  const [searching, setSearching] = useState(false);\r\n  const [searchResults, setSearchResults] = useState<SearchResult[]>([]);\r\n\r\n  // Stats state\r\n  const [stats, setStats] = useState<Stats | null>(null);\r\n  const [loadingStats, setLoadingStats] = useState(false);\r\n\r\n  // Books state\r\n  const [books, setBooks] = useState<Array<{\r\n    grade: string;\r\n    volume: number;\r\n    volumeType: string;\r\n    subject: string;\r\n    chunksCount: number;\r\n    source?: string;\r\n    grades?: string[]; // For curriculum - multiple grades\r\n  }>>([]);\r\n  const [loadingBooks, setLoadingBooks] = useState(false);\r\n  const [deletingBook, setDeletingBook] = useState<string | null>(null);\r\n  const [deleteResult, setDeleteResult] = useState<{ success: boolean; message: string } | null>(null);\r\n\r\n  // Migration state\r\n  const [migrating, setMigrating] = useState(false);\r\n  const [migrationResult, setMigrationResult] = useState<{ success: boolean; message: string } | null>(null);\r\n\r\n  // Active tab\r\n  const [activeTab, setActiveTab] = useState<'upload' | 'search' | 'stats' | 'reference_exams'>('upload');\r\n\r\n  // Load stats, books, and pending progress on mount\r\n  useEffect(() => {\r\n    loadStats();\r\n    loadBooks();\r\n    loadPendingProgress();\r\n  }, []);\r\n\r\n  // Real-time progress listener\r\n  useEffect(() => {\r\n    if (!batchProgressId) {\r\n      setLiveProgress(null);\r\n      return;\r\n    }\r\n\r\n    const progressRef = doc(db, 'extraction_progress', batchProgressId);\r\n    const unsubscribe = onSnapshot(progressRef, (snapshot) => {\r\n      if (snapshot.exists()) {\r\n        const data = snapshot.data();\r\n        setLiveProgress({\r\n          processedPages: data.processedPages || 0,\r\n          totalPages: data.totalPages || 0,\r\n          currentPage: data.currentPage,\r\n          status: data.status,\r\n        });\r\n      }\r\n    }, (error) => {\r\n      console.error('Progress listener error:', error);\r\n    });\r\n\r\n    return () => unsubscribe();\r\n  }, [batchProgressId]);\r\n\r\n  // Load any pending extraction progress from Firestore\r\n  const loadPendingProgress = async () => {\r\n    try {\r\n      const progressQuery = query(\r\n        collection(db, 'extraction_progress'),\r\n        orderBy('createdAt', 'desc'),\r\n        limit(1)\r\n      );\r\n      const snapshot = await getDocs(progressQuery);\r\n\r\n      if (!snapshot.empty) {\r\n        const doc = snapshot.docs[0];\r\n        const data = doc.data();\r\n\r\n        // Set the progress state\r\n        setBatchProgressId(doc.id);\r\n        setUploadResult({\r\n          success: false,\r\n          documentId: doc.id,\r\n          chunksCreated: 0,\r\n          chaptersFound: [],\r\n          processingTimeMs: 0,\r\n          progress: {\r\n            processedPages: data.processedPages || 0,\r\n            totalPages: data.totalPages || 0,\r\n            percentComplete: data.totalPages ? Math.round((data.processedPages / data.totalPages) * 100) : 0,\r\n          },\r\n        });\r\n      }\r\n    } catch (error) {\r\n      console.error('Failed to load pending progress:', error);\r\n    }\r\n  };\r\n\r\n  const loadBooks = async () => {\r\n    setLoadingBooks(true);\r\n    try {\r\n      const getBooksFunc = httpsCallable(functions, 'getKnowledgeBooks');\r\n      const result = await getBooksFunc({});\r\n      const data = result.data as { books: typeof books };\r\n      setBooks(data.books);\r\n    } catch (error: any) {\r\n      console.error('Failed to load books:', error);\r\n    } finally {\r\n      setLoadingBooks(false);\r\n    }\r\n  };\r\n\r\n  const loadStats = async () => {\r\n    setLoadingStats(true);\r\n    try {\r\n      const getStatsFunc = httpsCallable(functions, 'getKnowledgeStats');\r\n      const result = await getStatsFunc({});\r\n      setStats(result.data as Stats);\r\n    } catch (error: any) {\r\n      console.error('Failed to load stats:', error);\r\n    } finally {\r\n      setLoadingStats(false);\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const selectedFile = e.target.files?.[0];\r\n    if (selectedFile) {\r\n      setFile(selectedFile);\r\n      setUploadResult(null);\r\n    }\r\n  };\r\n\r\n  const handleUpload = async () => {\r\n    if (!file || !currentUser) return;\r\n\r\n    setUploading(true);\r\n    setUploadResult(null);\r\n    setUploadProgress('××¢×œ×” ×§×•×‘×¥ ×œ-Storage...');\r\n\r\n    try {\r\n      // Step 1: Upload to Firebase Storage first (bypasses Cloud Function size limits)\r\n      const timestamp = Date.now();\r\n      const storagePath = `knowledge-base/${currentUser.uid}/${timestamp}_${file.name}`;\r\n      const storageRef = ref(storage, storagePath);\r\n\r\n      await uploadBytes(storageRef, file);\r\n      const fileUrl = await getDownloadURL(storageRef);\r\n\r\n      setUploadProgress('××¢×‘×“ ××ª ×”×§×•×‘×¥ ×¢× AI...');\r\n\r\n      // Step 2: Call Cloud Function with Storage URL (not base64)\r\n      const uploadFunc = httpsCallable(functions, 'uploadKnowledge', { timeout: 300000 });\r\n      const result = await uploadFunc({\r\n        fileUrl,\r\n        storagePath,\r\n        mimeType: file.type,\r\n        fileName: file.name,\r\n        subject,\r\n        grade: volumeType === 'curriculum' ? selectedGrades[0] : grade, // For curriculum, use first selected grade as primary\r\n        volume: volumeType === 'curriculum' ? 0 : volume, // Curriculum doesn't use volume\r\n        volumeType,\r\n        // For curriculum, pass all selected grades\r\n        ...(volumeType === 'curriculum' && { grades: selectedGrades }),\r\n      });\r\n\r\n      const response = result.data as UploadResponse;\r\n      setUploadResult(response);\r\n      setUploadProgress('');\r\n\r\n      // Check if batch processing is in progress\r\n      if (!response.success && response.documentId && response.progress) {\r\n        setBatchProgressId(response.documentId);\r\n      } else {\r\n        setBatchProgressId(null);\r\n      }\r\n\r\n      // Refresh stats\r\n      if (response.success) {\r\n        loadStats();\r\n        loadBooks();\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Upload failed:', error);\r\n      setUploadProgress('');\r\n      setUploadResult({\r\n        success: false,\r\n        documentId: '',\r\n        chunksCreated: 0,\r\n        chaptersFound: [],\r\n        processingTimeMs: 0,\r\n        errors: [error.message],\r\n      });\r\n    } finally {\r\n      setUploading(false);\r\n    }\r\n  };\r\n\r\n  const handleSearch = async () => {\r\n    if (!searchQuery.trim()) return;\r\n\r\n    setSearching(true);\r\n    setSearchResults([]);\r\n\r\n    try {\r\n      const searchFunc = httpsCallable(functions, 'searchKnowledge');\r\n      const result = await searchFunc({\r\n        query: searchQuery,\r\n        filters: {\r\n          subject: 'math',\r\n          ...(searchGrade && { grade: searchGrade }),\r\n          ...(searchVolumeType && { volumeType: searchVolumeType }),\r\n        },\r\n        limit: 10,\r\n      });\r\n\r\n      const data = result.data as { results: SearchResult[] };\r\n      setSearchResults(data.results);\r\n    } catch (error: any) {\r\n      console.error('Search failed:', error);\r\n    } finally {\r\n      setSearching(false);\r\n    }\r\n  };\r\n\r\n  const handleContinueBatch = async () => {\r\n    if (!batchProgressId || !currentUser) return;\r\n\r\n    setContinuing(true);\r\n    setUploadProgress('×××©×™×š ×‘×¢×™×‘×•×“ ×”×¡×¤×¨...');\r\n\r\n    try {\r\n      const continueFunc = httpsCallable(functions, 'continueKnowledgeExtraction', { timeout: 600000 });\r\n      const result = await continueFunc({ progressId: batchProgressId });\r\n\r\n      const response = result.data as UploadResponse;\r\n      setUploadResult(response);\r\n      setUploadProgress('');\r\n\r\n      // Check if still needs more batches\r\n      if (!response.success && response.documentId && response.progress) {\r\n        setBatchProgressId(response.documentId);\r\n      } else {\r\n        setBatchProgressId(null);\r\n        // Refresh stats if complete\r\n        if (response.success) {\r\n          loadStats();\r\n          loadBooks();\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Continue batch failed:', error);\r\n      setUploadProgress('');\r\n      setUploadResult({\r\n        success: false,\r\n        documentId: batchProgressId,\r\n        chunksCreated: 0,\r\n        chaptersFound: [],\r\n        processingTimeMs: 0,\r\n        errors: [error.message],\r\n      });\r\n    } finally {\r\n      setContinuing(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteBook = async (book: typeof books[0]) => {\r\n    const bookName = book.volumeType === 'teacher' ? '××“×¨×™×š ×œ××•×¨×”' : '×¡×¤×¨ ×ª×œ××™×“';\r\n    if (!window.confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ${bookName} ×›×™×ª×” ${book.grade}' ×›×¨×š ${book.volume}?\\n\\n×¤×¢×•×œ×” ×–×• ××™× ×” ×”×¤×™×›×”!`)) {\r\n      return;\r\n    }\r\n\r\n    const bookKey = `${book.grade}-${book.volume}-${book.volumeType}`;\r\n    setDeletingBook(bookKey);\r\n    setDeleteResult(null);\r\n\r\n    try {\r\n      const deleteFunc = httpsCallable(functions, 'deleteKnowledgeBook', { timeout: 300000 });\r\n      const result = await deleteFunc({\r\n        grade: book.grade,\r\n        volume: book.volume,\r\n        volumeType: book.volumeType,\r\n      });\r\n      const data = result.data as { success: boolean; message: string; deletedCount: number };\r\n\r\n      setDeleteResult({\r\n        success: data.success,\r\n        message: data.message,\r\n      });\r\n\r\n      // Refresh stats and books after deletion\r\n      loadStats();\r\n      loadBooks();\r\n    } catch (error: any) {\r\n      console.error('Delete failed:', error);\r\n      setDeleteResult({\r\n        success: false,\r\n        message: error.message || '×©×’×™××” ×‘××—×™×§×”',\r\n      });\r\n    } finally {\r\n      setDeletingBook(null);\r\n    }\r\n  };\r\n\r\n  // Migrate knowledge books to textbooks\r\n  const handleMigrateToTextbooks = async () => {\r\n    if (!window.confirm('×”×× ×œ×¡× ×›×¨×Ÿ ××ª ×›×œ ×”×¡×¤×¨×™× ××‘×¡×™×¡ ×”×™×“×¢ ×œ××¢×¨×›×ª ×”×¡×¤×¨×™×?\\n\\n×¤×¢×•×œ×” ×–×• ×ª×™×¦×•×¨ ×¨×©×•××•×ª ×¡×¤×¨ ×¢×‘×•×¨ ×›×œ ×”×¡×¤×¨×™× ×©×§×™×™××™× ×‘×‘×¡×™×¡ ×”×™×“×¢.')) {\r\n      return;\r\n    }\r\n\r\n    setMigrating(true);\r\n    setMigrationResult(null);\r\n\r\n    try {\r\n      const migrateFunc = httpsCallable(functions, 'migrateKnowledgeBooksToTextbooks', { timeout: 540000 });\r\n      const result = await migrateFunc({});\r\n      const data = result.data as {\r\n        success: boolean;\r\n        totalBooks: number;\r\n        created: number;\r\n        failed: number;\r\n        results: Array<{ key: string; success: boolean; error?: string }>;\r\n      };\r\n\r\n      setMigrationResult({\r\n        success: data.success,\r\n        message: `×¡× ×›×¨×•×Ÿ ×”×•×©×œ×!\\n× ××¦××• ${data.totalBooks} ×¡×¤×¨×™×\\n× ×•×¦×¨×• ${data.created} ×¨×©×•××•×ª ×—×“×©×•×ª\\n× ×›×©×œ×• ${data.failed}`,\r\n      });\r\n\r\n      // Refresh books list\r\n      loadBooks();\r\n    } catch (error: any) {\r\n      console.error('Migration failed:', error);\r\n      setMigrationResult({\r\n        success: false,\r\n        message: error.message || '×©×’×™××” ×‘×¡× ×›×¨×•×Ÿ',\r\n      });\r\n    } finally {\r\n      setMigrating(false);\r\n    }\r\n  };\r\n\r\n  // Create review for a book\r\n  const [creatingReview, setCreatingReview] = useState<string | null>(null);\r\n\r\n  const handleCreateReview = async (book: typeof books[0]) => {\r\n    const bookKey = `${book.grade}-${book.volume}-${book.volumeType}`;\r\n    setCreatingReview(bookKey);\r\n\r\n    try {\r\n      const createReviewFunc = httpsCallable(functions, 'createReviewForExistingBook');\r\n      const result = await createReviewFunc({\r\n        grade: book.grade,\r\n        volume: book.volume,\r\n        volumeType: book.volumeType,\r\n        // For curriculum, pass the grades array\r\n        ...(book.volumeType === 'curriculum' && book.grades && { grades: book.grades }),\r\n      });\r\n      const data = result.data as { success: boolean; reviewId: string; totalPages: number };\r\n\r\n      if (data.success) {\r\n        alert(`× ×•×¦×¨×” ×¡×§×™×¨×” ×‘×”×¦×œ×—×”!\\n××–×”×”: ${data.reviewId}\\n×¢××•×“×™×: ${data.totalPages}`);\r\n        // Navigate to review page if available\r\n        if (onNavigateToReview) {\r\n          onNavigateToReview();\r\n        }\r\n      }\r\n    } catch (error: any) {\r\n      console.error('Create review failed:', error);\r\n      alert('×©×’×™××” ×‘×™×¦×™×¨×ª ×¡×§×™×¨×”: ' + error.message);\r\n    } finally {\r\n      setCreatingReview(null);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 p-6\" dir=\"rtl\">\r\n      <div className=\"max-w-6xl mx-auto\">\r\n        {/* Header */}\r\n        <div className=\"mb-8 flex justify-between items-start\">\r\n          <div>\r\n            <h1 className=\"text-3xl font-bold text-gray-900\">×‘×¡×™×¡ ×”×™×“×¢ - ××ª××˜×™×§×”</h1>\r\n            <p className=\"text-gray-600 mt-2\">\r\n              × ×™×”×•×œ ×ª×•×›×Ÿ ××ª××˜×™ ×œ×©×™××•×© ×‘×™×¦×™×¨×ª ×©××œ×•×ª ×•×ª×›× ×™× ×—×›××™×\r\n            </p>\r\n          </div>\r\n          {onNavigateToReview && (\r\n            <button\r\n              onClick={onNavigateToReview}\r\n              className=\"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 flex items-center gap-2\"\r\n            >\r\n              <span>ğŸ”</span>\r\n              ×¡×§×™×¨×ª ×—×™×œ×•×¥ ×˜×§×¡×˜\r\n            </button>\r\n          )}\r\n        </div>\r\n\r\n        {/* Tabs */}\r\n        <div className=\"flex gap-4 mb-6 border-b\">\r\n          <button\r\n            onClick={() => setActiveTab('upload')}\r\n            className={`px-4 py-2 font-medium ${\r\n              activeTab === 'upload'\r\n                ? 'border-b-2 border-blue-500 text-blue-600'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            ×”×¢×œ××ª ×¡×¤×¨\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('search')}\r\n            className={`px-4 py-2 font-medium ${\r\n              activeTab === 'search'\r\n                ? 'border-b-2 border-blue-500 text-blue-600'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            ×—×™×¤×•×©\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('stats')}\r\n            className={`px-4 py-2 font-medium ${\r\n              activeTab === 'stats'\r\n                ? 'border-b-2 border-blue-500 text-blue-600'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            ×¡×˜×˜×™×¡×˜×™×§×•×ª\r\n          </button>\r\n          <button\r\n            onClick={() => setActiveTab('reference_exams')}\r\n            className={`px-4 py-2 font-medium ${\r\n              activeTab === 'reference_exams'\r\n                ? 'border-b-2 border-purple-500 text-purple-600'\r\n                : 'text-gray-500 hover:text-gray-700'\r\n            }`}\r\n          >\r\n            ××‘×—× ×™ ×™×™×—×•×¡\r\n          </button>\r\n        </div>\r\n\r\n        {/* Upload Tab */}\r\n        {activeTab === 'upload' && (\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">×”×¢×œ××ª ×¡×¤×¨ ×—×“×©</h2>\r\n\r\n            <div className=\"space-y-4\">\r\n              {/* File Input */}\r\n              <div>\r\n                <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                  ×§×•×‘×¥ PDF\r\n                </label>\r\n                <input\r\n                  type=\"file\"\r\n                  accept=\".pdf\"\r\n                  onChange={handleFileChange}\r\n                  className=\"block w-full text-sm text-gray-500\r\n                    file:mr-4 file:py-2 file:px-4\r\n                    file:rounded-md file:border-0\r\n                    file:text-sm file:font-semibold\r\n                    file:bg-blue-50 file:text-blue-700\r\n                    hover:file:bg-blue-100\"\r\n                />\r\n                {file && (\r\n                  <p className=\"mt-1 text-sm text-gray-500\">\r\n                    × ×‘×—×¨: {file.name} ({(file.size / 1024 / 1024).toFixed(2)} MB)\r\n                  </p>\r\n                )}\r\n              </div>\r\n\r\n              {/* Metadata */}\r\n              <div className=\"grid grid-cols-2 md:grid-cols-4 gap-4\">\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    ××§×¦×•×¢\r\n                  </label>\r\n                  <select\r\n                    value={subject}\r\n                    onChange={(e) => setSubject(e.target.value)}\r\n                    className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                  >\r\n                    {SUBJECTS.map((s) => (\r\n                      <option key={s.value} value={s.value}>\r\n                        {s.label}\r\n                      </option>\r\n                    ))}\r\n                  </select>\r\n                </div>\r\n\r\n                <div>\r\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                    ×¡×•×’\r\n                  </label>\r\n                  <select\r\n                    value={volumeType}\r\n                    onChange={(e) => setVolumeType(e.target.value as 'student' | 'teacher' | 'curriculum')}\r\n                    className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                  >\r\n                    <option value=\"student\">×¡×¤×¨ ×ª×œ××™×“</option>\r\n                    <option value=\"teacher\">××“×¨×™×š ×œ××•×¨×”</option>\r\n                    <option value=\"curriculum\">×ª×•×›× ×™×ª ×œ×™××•×“×™×</option>\r\n                  </select>\r\n                </div>\r\n\r\n                {/* For textbooks: single grade + volume */}\r\n                {volumeType !== 'curriculum' && (\r\n                  <>\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        ×›×™×ª×”\r\n                      </label>\r\n                      <select\r\n                        value={grade}\r\n                        onChange={(e) => setGrade(e.target.value)}\r\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                      >\r\n                        {GRADES.map((g) => (\r\n                          <option key={g} value={g}>\r\n                            ×›×™×ª×” {g}×³\r\n                          </option>\r\n                        ))}\r\n                      </select>\r\n                    </div>\r\n\r\n                    <div>\r\n                      <label className=\"block text-sm font-medium text-gray-700 mb-1\">\r\n                        ×›×¨×š\r\n                      </label>\r\n                      <input\r\n                        type=\"number\"\r\n                        min={1}\r\n                        max={10}\r\n                        value={volume}\r\n                        onChange={(e) => setVolume(parseInt(e.target.value) || 1)}\r\n                        className=\"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                      />\r\n                    </div>\r\n                  </>\r\n                )}\r\n              </div>\r\n\r\n              {/* For curriculum: multi-grade selection */}\r\n              {volumeType === 'curriculum' && (\r\n                <div className=\"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg\">\r\n                  <label className=\"block text-sm font-medium text-green-800 mb-2\">\r\n                    ×©×›×‘×•×ª (× ×™×ª×Ÿ ×œ×‘×—×•×¨ ××¡×¤×¨ ×›×™×ª×•×ª)\r\n                  </label>\r\n                  <div className=\"flex flex-wrap gap-2\">\r\n                    {GRADES.map((g) => {\r\n                      const isSelected = selectedGrades.includes(g);\r\n                      return (\r\n                        <button\r\n                          key={g}\r\n                          type=\"button\"\r\n                          onClick={() => {\r\n                            if (isSelected) {\r\n                              // Don't allow deselecting if it's the last one\r\n                              if (selectedGrades.length > 1) {\r\n                                setSelectedGrades(selectedGrades.filter(sg => sg !== g));\r\n                              }\r\n                            } else {\r\n                              setSelectedGrades([...selectedGrades, g]);\r\n                            }\r\n                          }}\r\n                          className={`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${\r\n                            isSelected\r\n                              ? 'bg-green-600 text-white'\r\n                              : 'bg-white text-green-700 border border-green-300 hover:bg-green-100'\r\n                          }`}\r\n                        >\r\n                          {g}×³\r\n                        </button>\r\n                      );\r\n                    })}\r\n                  </div>\r\n                  <p className=\"mt-2 text-xs text-green-600\">\r\n                    × ×‘×—×¨×•: {selectedGrades.sort((a, b) => GRADES.indexOf(a) - GRADES.indexOf(b)).map(g => `${g}×³`).join(', ')}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Upload Button */}\r\n              <button\r\n                onClick={handleUpload}\r\n                disabled={!file || uploading}\r\n                className={`w-full py-3 px-4 rounded-md font-medium text-white ${\r\n                  !file || uploading\r\n                    ? 'bg-gray-400 cursor-not-allowed'\r\n                    : 'bg-blue-600 hover:bg-blue-700'\r\n                }`}\r\n              >\r\n                {uploading ? (\r\n                  <span className=\"flex items-center justify-center gap-2\">\r\n                    <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\r\n                      <circle\r\n                        className=\"opacity-25\"\r\n                        cx=\"12\"\r\n                        cy=\"12\"\r\n                        r=\"10\"\r\n                        stroke=\"currentColor\"\r\n                        strokeWidth=\"4\"\r\n                        fill=\"none\"\r\n                      />\r\n                      <path\r\n                        className=\"opacity-75\"\r\n                        fill=\"currentColor\"\r\n                        d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\r\n                      />\r\n                    </svg>\r\n                    {uploadProgress || '××¢×‘×“... (×–×” ×™×›×•×œ ×œ×§×—×ª ×›××” ×“×§×•×ª)'}\r\n                  </span>\r\n                ) : (\r\n                  '×”×¢×œ×” ×•××¨×’×Ÿ'\r\n                )}\r\n              </button>\r\n\r\n              {/* Real-time Progress Bar */}\r\n              {(uploading || continuing) && liveProgress && liveProgress.totalPages > 0 && (\r\n                <div className=\"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg\">\r\n                  <div className=\"flex items-center justify-between mb-2\">\r\n                    <span className=\"text-sm font-medium text-blue-800\">\r\n                      ××¢×‘×“ ×¢××•×“ {liveProgress.currentPage || liveProgress.processedPages} ××ª×•×š {liveProgress.totalPages}\r\n                    </span>\r\n                    <span className=\"text-sm font-bold text-blue-600\">\r\n                      {Math.round((liveProgress.processedPages / liveProgress.totalPages) * 100)}%\r\n                    </span>\r\n                  </div>\r\n                  <div className=\"w-full h-3 bg-blue-200 rounded-full overflow-hidden\">\r\n                    <div\r\n                      className=\"h-full bg-blue-600 rounded-full transition-all duration-500 ease-out\"\r\n                      style={{ width: `${(liveProgress.processedPages / liveProgress.totalPages) * 100}%` }}\r\n                    />\r\n                  </div>\r\n                  <p className=\"mt-2 text-xs text-blue-600\">\r\n                    {liveProgress.status === 'processing' ? '××—×œ×¥ ×˜×§×¡×˜ ×¢× AI...' :\r\n                     liveProgress.status === 'saving' ? '×©×•××¨ ×œ×‘×¡×™×¡ ×”× ×ª×•× ×™×...' :\r\n                     '××¢×‘×“...'}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Upload Result */}\r\n              {uploadResult && (\r\n                <div\r\n                  className={`mt-4 p-4 rounded-md ${\r\n                    uploadResult.success\r\n                      ? 'bg-green-50 border border-green-200'\r\n                      : uploadResult.progress\r\n                      ? 'bg-blue-50 border border-blue-200'\r\n                      : 'bg-red-50 border border-red-200'\r\n                  }`}\r\n                >\r\n                  {uploadResult.success ? (\r\n                    <>\r\n                      <h3 className=\"font-medium text-green-800\">×”×¢×œ××” ×”×¦×œ×™×—×”!</h3>\r\n                      <ul className=\"mt-2 text-sm text-green-700 space-y-1\">\r\n                        <li>× ×•×¦×¨×• {uploadResult.chunksCreated} ×§×˜×¢×™×</li>\r\n                        <li>×–××Ÿ ×¢×™×‘×•×“: {(uploadResult.processingTimeMs / 1000).toFixed(1)} ×©× ×™×•×ª</li>\r\n                        <li>\r\n                          ×¤×¨×§×™× ×©× ××¦××•: {uploadResult.chaptersFound.join(', ') || '×œ× ×–×•×”×• ×¤×¨×§×™×'}\r\n                        </li>\r\n                      </ul>\r\n\r\n                      {/* Extraction Quality Metrics */}\r\n                      {uploadResult.extractionQuality && (\r\n                        <div className=\"mt-4 pt-3 border-t border-green-200\">\r\n                          <h4 className=\"font-medium text-green-800 mb-2\">××™×›×•×ª ×”×—×™×œ×•×¥:</h4>\r\n                          <div className=\"space-y-2\">\r\n                            <div className=\"flex items-center gap-2\">\r\n                              <span className=\"text-sm text-green-700\">×©×™×˜×”:</span>\r\n                              <span className={`text-xs px-2 py-1 rounded ${\r\n                                uploadResult.extractionQuality.method === 'high_quality' ||\r\n                                uploadResult.extractionQuality.method === 'high_quality_batch'\r\n                                  ? 'bg-green-200 text-green-800'\r\n                                  : 'bg-yellow-200 text-yellow-800'\r\n                              }`}>\r\n                                {uploadResult.extractionQuality.method === 'high_quality'\r\n                                  ? '×—×™×œ×•×¥ ×‘××™×›×•×ª ×’×‘×•×”×” (Gemini)'\r\n                                  : uploadResult.extractionQuality.method === 'high_quality_batch'\r\n                                  ? '×—×™×œ×•×¥ ×‘××™×›×•×ª ×’×‘×•×”×” - Batch (Gemini)'\r\n                                  : uploadResult.extractionQuality.method}\r\n                              </span>\r\n                            </div>\r\n\r\n                            {uploadResult.extractionQuality.averageConfidence !== undefined && (\r\n                              <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-sm text-green-700\">×¨××ª ×•×“××•×ª:</span>\r\n                                <div className=\"flex items-center gap-2\">\r\n                                  <div className=\"w-32 h-2 bg-gray-200 rounded-full overflow-hidden\">\r\n                                    <div\r\n                                      className={`h-full rounded-full ${\r\n                                        uploadResult.extractionQuality.averageConfidence >= 0.9\r\n                                          ? 'bg-green-500'\r\n                                          : uploadResult.extractionQuality.averageConfidence >= 0.8\r\n                                          ? 'bg-yellow-500'\r\n                                          : 'bg-red-500'\r\n                                      }`}\r\n                                      style={{ width: `${uploadResult.extractionQuality.averageConfidence * 100}%` }}\r\n                                    />\r\n                                  </div>\r\n                                  <span className={`text-sm font-medium ${\r\n                                    uploadResult.extractionQuality.averageConfidence >= 0.9\r\n                                      ? 'text-green-700'\r\n                                      : uploadResult.extractionQuality.averageConfidence >= 0.8\r\n                                      ? 'text-yellow-700'\r\n                                      : 'text-red-700'\r\n                                  }`}>\r\n                                    {(uploadResult.extractionQuality.averageConfidence * 100).toFixed(1)}%\r\n                                  </span>\r\n                                </div>\r\n                              </div>\r\n                            )}\r\n\r\n                            {uploadResult.extractionQuality.pagesNeedingReview &&\r\n                             uploadResult.extractionQuality.pagesNeedingReview.length > 0 && (\r\n                              <div className=\"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded\">\r\n                                <p className=\"text-sm text-yellow-800 font-medium\">\r\n                                  ×¢××•×“×™× ×”×“×•×¨×©×™× ×‘×“×™×§×” ×™×“× ×™×ª:\r\n                                </p>\r\n                                <p className=\"text-sm text-yellow-700\">\r\n                                  ×¢××•×“×™× {uploadResult.extractionQuality.pagesNeedingReview.join(', ')}\r\n                                </p>\r\n                              </div>\r\n                            )}\r\n                          </div>\r\n                        </div>\r\n                      )}\r\n                    </>\r\n                  ) : uploadResult.progress ? (\r\n                    // Batch processing in progress\r\n                    <>\r\n                      <h3 className=\"font-medium text-blue-800 flex items-center gap-2\">\r\n                        <span>ğŸ“š</span>\r\n                        ×¢×™×‘×•×“ ×¡×¤×¨ ×’×“×•×œ ×‘×”×ª×§×“××•×ª\r\n                      </h3>\r\n                      <div className=\"mt-3 space-y-3\">\r\n                        <div className=\"flex items-center gap-2\">\r\n                          <span className=\"text-sm text-blue-700\">×”×ª×§×“××•×ª:</span>\r\n                          <div className=\"flex-1 h-4 bg-blue-200 rounded-full overflow-hidden\">\r\n                            <div\r\n                              className=\"h-full bg-blue-600 transition-all duration-300\"\r\n                              style={{ width: `${uploadResult.progress.percentComplete}%` }}\r\n                            />\r\n                          </div>\r\n                          <span className=\"text-sm font-medium text-blue-800\">\r\n                            {uploadResult.progress.percentComplete}%\r\n                          </span>\r\n                        </div>\r\n                        <p className=\"text-sm text-blue-700\">\r\n                          ×¢××•×“×™×: {uploadResult.progress.processedPages} / {uploadResult.progress.totalPages}\r\n                        </p>\r\n                        <p className=\"text-xs text-blue-600\">\r\n                          ×¡×¤×¨×™× ×’×“×•×œ×™× ××¢×•×‘×“×™× ×‘×—×œ×§×™× (40 ×¢××•×“×™× ×‘×›×œ ×¤×¢×) ×‘×’×œ×œ ××’×‘×œ×•×ª ×–××Ÿ.\r\n                        </p>\r\n                        <button\r\n                          onClick={handleContinueBatch}\r\n                          disabled={continuing}\r\n                          className={`w-full py-3 px-4 rounded-md font-medium text-white ${\r\n                            continuing\r\n                              ? 'bg-blue-400 cursor-not-allowed'\r\n                              : 'bg-blue-600 hover:bg-blue-700'\r\n                          }`}\r\n                        >\r\n                          {continuing ? (\r\n                            <span className=\"flex items-center justify-center gap-2\">\r\n                              <svg className=\"animate-spin h-5 w-5\" viewBox=\"0 0 24 24\">\r\n                                <circle\r\n                                  className=\"opacity-25\"\r\n                                  cx=\"12\"\r\n                                  cy=\"12\"\r\n                                  r=\"10\"\r\n                                  stroke=\"currentColor\"\r\n                                  strokeWidth=\"4\"\r\n                                  fill=\"none\"\r\n                                />\r\n                                <path\r\n                                  className=\"opacity-75\"\r\n                                  fill=\"currentColor\"\r\n                                  d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\r\n                                />\r\n                              </svg>\r\n                              {uploadProgress || '×××©×™×š ×‘×¢×™×‘×•×“...'}\r\n                            </span>\r\n                          ) : (\r\n                            'â–¶ï¸ ×”××©×š ×¢×™×‘×•×“'\r\n                          )}\r\n                        </button>\r\n                      </div>\r\n                    </>\r\n                  ) : (\r\n                    <>\r\n                      <h3 className=\"font-medium text-red-800\">×”×¢×œ××” × ×›×©×œ×”</h3>\r\n                      <ul className=\"mt-2 text-sm text-red-700\">\r\n                        {uploadResult.errors?.map((err, i) => (\r\n                          <li key={i}>{err}</li>\r\n                        ))}\r\n                      </ul>\r\n                    </>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Search Tab */}\r\n        {activeTab === 'search' && (\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <h2 className=\"text-xl font-semibold mb-4\">×—×™×¤×•×© ×‘×‘×¡×™×¡ ×”×™×“×¢</h2>\r\n\r\n            <div className=\"space-y-4\">\r\n              {/* Search Input */}\r\n              <div className=\"flex gap-4\">\r\n                <input\r\n                  type=\"text\"\r\n                  value={searchQuery}\r\n                  onChange={(e) => setSearchQuery(e.target.value)}\r\n                  placeholder=\"×—×¤×© × ×•×©×... (×œ××©×œ: ×—×™×‘×•×¨ ×¢×“ 100, ×©×‘×¨×™×, ×©×˜×— ××œ×‘×Ÿ)\"\r\n                  className=\"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                  onKeyDown={(e) => e.key === 'Enter' && handleSearch()}\r\n                />\r\n                <button\r\n                  onClick={handleSearch}\r\n                  disabled={searching || !searchQuery.trim()}\r\n                  className=\"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400\"\r\n                >\r\n                  {searching ? '××—×¤×©...' : '×—×¤×©'}\r\n                </button>\r\n              </div>\r\n\r\n              {/* Filters */}\r\n              <div className=\"flex gap-4\">\r\n                <select\r\n                  value={searchGrade}\r\n                  onChange={(e) => setSearchGrade(e.target.value)}\r\n                  className=\"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                >\r\n                  <option value=\"\">×›×œ ×”×›×™×ª×•×ª</option>\r\n                  {GRADES.map((g) => (\r\n                    <option key={g} value={g}>\r\n                      ×›×™×ª×” {g}×³\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n\r\n                <select\r\n                  value={searchVolumeType}\r\n                  onChange={(e) => setSearchVolumeType(e.target.value)}\r\n                  className=\"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500\"\r\n                >\r\n                  <option value=\"\">×›×œ ×”×¡×•×’×™×</option>\r\n                  <option value=\"student\">×¡×¤×¨ ×ª×œ××™×“</option>\r\n                  <option value=\"teacher\">××“×¨×™×š ×œ××•×¨×”</option>\r\n                  <option value=\"curriculum\">×ª×•×›× ×™×ª ×œ×™××•×“×™×</option>\r\n                </select>\r\n              </div>\r\n\r\n              {/* Results */}\r\n              {searchResults.length > 0 && (\r\n                <div className=\"mt-6 space-y-4\">\r\n                  <h3 className=\"font-medium text-gray-700\">\r\n                    × ××¦××• {searchResults.length} ×ª×•×¦××•×ª:\r\n                  </h3>\r\n\r\n                  {searchResults.map((result, index) => (\r\n                    <div\r\n                      key={result.chunk.id}\r\n                      className=\"border rounded-lg p-4 hover:bg-gray-50\"\r\n                    >\r\n                      <div className=\"flex justify-between items-start mb-2\">\r\n                        <div>\r\n                          <span className=\"font-medium\">{result.chunk.chapter}</span>\r\n                          <span className=\"text-sm text-gray-500 mr-2\">\r\n                            (×›×™×ª×” {result.chunk.grade}×³, ×›×¨×š {result.chunk.volume},\r\n                            {result.chunk.volumeType === 'teacher' ? ' ××“×¨×™×š ×œ××•×¨×”' : result.chunk.volumeType === 'curriculum' ? ' ×ª×•×›× ×™×ª ×œ×™××•×“×™×' : ' ×¡×¤×¨ ×ª×œ××™×“'})\r\n                          </span>\r\n                        </div>\r\n                        <span className=\"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded\">\r\n                          {(result.similarity * 100).toFixed(0)}% ×”×ª×××”\r\n                        </span>\r\n                      </div>\r\n\r\n                      <p className=\"text-gray-600 text-sm line-clamp-3\">\r\n                        {result.chunk.content}\r\n                      </p>\r\n\r\n                      <div className=\"mt-2 flex gap-2\">\r\n                        <span className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded\">\r\n                          {result.chunk.contentType}\r\n                        </span>\r\n                        {result.chunk.keywords.slice(0, 3).map((kw) => (\r\n                          <span\r\n                            key={kw}\r\n                            className=\"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded\"\r\n                          >\r\n                            {kw}\r\n                          </span>\r\n                        ))}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {searchResults.length === 0 && searchQuery && !searching && (\r\n                <p className=\"text-gray-500 text-center py-8\">\r\n                  ×œ× × ××¦××• ×ª×•×¦××•×ª. × ×¡×” ××•× ×—×™× ××—×¨×™×.\r\n                </p>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Stats Tab */}\r\n        {activeTab === 'stats' && (\r\n          <div className=\"bg-white rounded-lg shadow p-6\">\r\n            <div className=\"flex justify-between items-center mb-4\">\r\n              <h2 className=\"text-xl font-semibold\">×¡×˜×˜×™×¡×˜×™×§×•×ª ×‘×¡×™×¡ ×”×™×“×¢</h2>\r\n              <button\r\n                onClick={loadStats}\r\n                disabled={loadingStats}\r\n                className=\"text-blue-600 hover:text-blue-800\"\r\n              >\r\n                {loadingStats ? '×˜×•×¢×Ÿ...' : '×¨×¢× ×Ÿ'}\r\n              </button>\r\n            </div>\r\n\r\n            {stats ? (\r\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\r\n                {/* Total */}\r\n                <div className=\"bg-blue-50 rounded-lg p-4\">\r\n                  <h3 className=\"text-lg font-medium text-blue-900\">×¡×”×´×› ×§×˜×¢×™×</h3>\r\n                  <p className=\"text-4xl font-bold text-blue-600 mt-2\">\r\n                    {stats.totalChunks.toLocaleString()}\r\n                  </p>\r\n                </div>\r\n\r\n                {/* By Grade */}\r\n                <div className=\"bg-green-50 rounded-lg p-4\">\r\n                  <h3 className=\"text-lg font-medium text-green-900\">×œ×¤×™ ×›×™×ª×”</h3>\r\n                  <div className=\"mt-2 space-y-1\">\r\n                    {Object.entries(stats.byGrade)\r\n                      .sort(([a], [b]) => GRADES.indexOf(a) - GRADES.indexOf(b))\r\n                      .map(([g, count]) => (\r\n                        <div key={g} className=\"flex justify-between text-sm\">\r\n                          <span>×›×™×ª×” {g}×³</span>\r\n                          <span className=\"font-medium\">{count}</span>\r\n                        </div>\r\n                      ))}\r\n                  </div>\r\n                </div>\r\n\r\n                {/* By Type */}\r\n                <div className=\"bg-purple-50 rounded-lg p-4\">\r\n                  <h3 className=\"text-lg font-medium text-purple-900\">×œ×¤×™ ×¡×•×’</h3>\r\n                  <div className=\"mt-2 space-y-1\">\r\n                    {Object.entries(stats.byVolumeType).map(([type, count]) => (\r\n                      <div key={type} className=\"flex justify-between text-sm\">\r\n                        <span>{type === 'student' ? '×¡×¤×¨ ×ª×œ××™×“' : type === 'teacher' ? '××“×¨×™×š ×œ××•×¨×”' : type === 'curriculum' ? '×ª×•×›× ×™×ª ×œ×™××•×“×™×' : type}</span>\r\n                        <span className=\"font-medium\">{count}</span>\r\n                      </div>\r\n                    ))}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            ) : (\r\n              <p className=\"text-gray-500 text-center py-8\">\r\n                {loadingStats ? '×˜×•×¢×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª...' : '××™×Ÿ × ×ª×•× ×™× ×¢×“×™×™×Ÿ'}\r\n              </p>\r\n            )}\r\n\r\n            {/* Books List Section */}\r\n            <div className=\"mt-8 pt-6 border-t border-gray-200\">\r\n              <div className=\"flex justify-between items-center mb-4\">\r\n                <h3 className=\"text-lg font-semibold text-gray-800\">×¡×¤×¨×™× ×‘×‘×¡×™×¡ ×”×™×“×¢</h3>\r\n                <div className=\"flex gap-2\">\r\n                  <button\r\n                    onClick={handleMigrateToTextbooks}\r\n                    disabled={migrating}\r\n                    className={`px-3 py-1.5 rounded-md text-sm font-medium ${\r\n                      migrating\r\n                        ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                        : 'bg-green-100 text-green-700 hover:bg-green-200'\r\n                    }`}\r\n                  >\r\n                    {migrating ? (\r\n                      <span className=\"flex items-center gap-1\">\r\n                        <svg className=\"animate-spin h-3 w-3\" viewBox=\"0 0 24 24\">\r\n                          <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\" fill=\"none\" />\r\n                          <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\" />\r\n                        </svg>\r\n                        ××¡× ×›×¨×Ÿ...\r\n                      </span>\r\n                    ) : (\r\n                      'ğŸ”„ ×¡× ×›×¨×Ÿ ×œ××¢×¨×›×ª ×¡×¤×¨×™×'\r\n                    )}\r\n                  </button>\r\n                  <button\r\n                    onClick={loadBooks}\r\n                    disabled={loadingBooks}\r\n                    className=\"text-blue-600 hover:text-blue-800 text-sm\"\r\n                  >\r\n                    {loadingBooks ? '×˜×•×¢×Ÿ...' : '×¨×¢× ×Ÿ'}\r\n                  </button>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Migration Result */}\r\n              {migrationResult && (\r\n                <div\r\n                  className={`mb-4 p-3 rounded-md whitespace-pre-line ${\r\n                    migrationResult.success\r\n                      ? 'bg-green-100 border border-green-300'\r\n                      : 'bg-red-100 border border-red-300'\r\n                  }`}\r\n                >\r\n                  <p className={migrationResult.success ? 'text-green-800' : 'text-red-800'}>\r\n                    {migrationResult.message}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {/* Delete Result */}\r\n              {deleteResult && (\r\n                <div\r\n                  className={`mb-4 p-3 rounded-md ${\r\n                    deleteResult.success\r\n                      ? 'bg-green-100 border border-green-300'\r\n                      : 'bg-red-100 border border-red-300'\r\n                  }`}\r\n                >\r\n                  <p className={deleteResult.success ? 'text-green-800' : 'text-red-800'}>\r\n                    {deleteResult.message}\r\n                  </p>\r\n                </div>\r\n              )}\r\n\r\n              {loadingBooks ? (\r\n                <p className=\"text-gray-500 text-center py-4\">×˜×•×¢×Ÿ ×¨×©×™××ª ×¡×¤×¨×™×...</p>\r\n              ) : books.length === 0 ? (\r\n                <p className=\"text-gray-500 text-center py-4\">××™×Ÿ ×¡×¤×¨×™× ×‘×‘×¡×™×¡ ×”×™×“×¢</p>\r\n              ) : (\r\n                <div className=\"space-y-2\">\r\n                  {books.map((book) => {\r\n                    const bookKey = `${book.grade}-${book.volume}-${book.volumeType}`;\r\n                    const isDeleting = deletingBook === bookKey;\r\n                    const bookName = book.volumeType === 'teacher' ? '××“×¨×™×š ×œ××•×¨×”' : book.volumeType === 'curriculum' ? '×ª×•×›× ×™×ª ×œ×™××•×“×™×' : '×¡×¤×¨ ×ª×œ××™×“';\r\n                    const bgColor = book.volumeType === 'teacher' ? 'bg-purple-50 border-purple-200' : book.volumeType === 'curriculum' ? 'bg-green-50 border-green-200' : 'bg-blue-50 border-blue-200';\r\n                    const textColor = book.volumeType === 'teacher' ? 'text-purple-700' : book.volumeType === 'curriculum' ? 'text-green-700' : 'text-blue-700';\r\n\r\n                    return (\r\n                      <div\r\n                        key={bookKey}\r\n                        className={`flex items-center justify-between p-3 rounded-lg border ${bgColor}`}\r\n                      >\r\n                        <div className=\"flex items-center gap-4\">\r\n                          <span className=\"text-2xl\">\r\n                            {book.volumeType === 'teacher' ? 'ğŸ‘¨â€ğŸ«' : book.volumeType === 'curriculum' ? 'ğŸ“‹' : 'ğŸ“–'}\r\n                          </span>\r\n                          <div>\r\n                            <div className={`font-medium ${textColor}`}>\r\n                              {book.volumeType === 'curriculum'\r\n                                ? `${bookName} - ${book.grades && book.grades.length > 0\r\n                                    ? `×›×™×ª×•×ª ${book.grades.join('×³, ')}×³`\r\n                                    : `×›×™×ª×” ${book.grade}×³`}`\r\n                                : `${bookName} - ×›×™×ª×” ${book.grade}×³ ×›×¨×š ${book.volume}`}\r\n                            </div>\r\n                            <div className=\"text-sm text-gray-500\">\r\n                              {book.chunksCount} ×§×˜×¢×™×\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                        <div className=\"flex gap-2\">\r\n                          <button\r\n                            onClick={() => handleCreateReview(book)}\r\n                            disabled={creatingReview === bookKey}\r\n                            className={`px-3 py-1.5 rounded-md text-sm font-medium ${\r\n                              creatingReview === bookKey\r\n                                ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                                : 'bg-yellow-100 text-yellow-700 hover:bg-yellow-200'\r\n                            }`}\r\n                          >\r\n                            {creatingReview === bookKey ? '×™×•×¦×¨...' : 'ğŸ” ×¡×§×™×¨×”'}\r\n                          </button>\r\n                          <button\r\n                            onClick={() => handleDeleteBook(book)}\r\n                            disabled={isDeleting}\r\n                            className={`px-3 py-1.5 rounded-md text-sm font-medium ${\r\n                              isDeleting\r\n                                ? 'bg-gray-300 text-gray-500 cursor-not-allowed'\r\n                                : 'bg-red-100 text-red-700 hover:bg-red-200'\r\n                            }`}\r\n                        >\r\n                          {isDeleting ? (\r\n                            <span className=\"flex items-center gap-1\">\r\n                              <svg className=\"animate-spin h-3 w-3\" viewBox=\"0 0 24 24\">\r\n                                <circle\r\n                                  className=\"opacity-25\"\r\n                                  cx=\"12\"\r\n                                  cy=\"12\"\r\n                                  r=\"10\"\r\n                                  stroke=\"currentColor\"\r\n                                  strokeWidth=\"4\"\r\n                                  fill=\"none\"\r\n                                />\r\n                                <path\r\n                                  className=\"opacity-75\"\r\n                                  fill=\"currentColor\"\r\n                                  d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z\"\r\n                                />\r\n                              </svg>\r\n                              ××•×—×§...\r\n                            </span>\r\n                          ) : (\r\n                            'ğŸ—‘ï¸ ××—×§'\r\n                          )}\r\n                          </button>\r\n                        </div>\r\n                      </div>\r\n                    );\r\n                  })}\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        )}\r\n\r\n        {/* Reference Exams Tab */}\r\n        {activeTab === 'reference_exams' && (\r\n          <div className=\"space-y-6\">\r\n            <div className=\"bg-purple-50 border border-purple-200 rounded-lg p-4\">\r\n              <h3 className=\"text-lg font-semibold text-purple-800 mb-2\">××‘×—× ×™ ×™×™×—×•×¡</h3>\r\n              <p className=\"text-purple-700 text-sm\">\r\n                ××‘×—× ×™ ×™×™×—×•×¡ ×”× ××‘×—× ×™× ×§×™×™××™× (××“×¨×™×›×™ ××•×¨×”, ××©×¨×“ ×”×—×™× ×•×š) ×©××©××©×™× ×›×ª×‘× ×™×•×ª ×œ×™×¦×™×¨×ª ××‘×—× ×™× ×—×“×©×™×.\r\n                ×”××¢×¨×›×ª ××—×œ×¦×ª ××ª ×”-DNA ×©×œ ×”××‘×—×Ÿ (××‘× ×”, ×¡×•×’×™ ×©××œ×•×ª, ×¨××•×ª ×§×•×©×™) ×•××©×ª××©×ª ×‘×• ×œ×™×™×¦×¨ ××‘×—× ×™× ×¢× ××•×ª×•\r\n                ××‘× ×” ××‘×œ ×©××œ×•×ª ×—×“×©×•×ª ××ª×•×›×Ÿ ×”×¡×¤×¨.\r\n              </p>\r\n            </div>\r\n\r\n            {/* Upload Form */}\r\n            <ReferenceExamUpload\r\n              onUploadComplete={() => {\r\n                // Refresh the list after successful upload\r\n              }}\r\n            />\r\n\r\n            {/* Existing Exams List */}\r\n            <ReferenceExamsList />\r\n          </div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":["QUESTION_TYPE_LABELS","BLOOM_LABELS","DIFFICULTY_LABELS","FORMALITY_LABELS","DistributionBar","label","percentage","color","jsxs","jsx","ExamDnaViewer","dna","compact","confidenceColor","_","pct","type","level","EXAM_TYPES","GRADES","VOLUMES","SUBJECTS","ReferenceExamUpload","onUploadComplete","currentUser","useAuth","file","setFile","useState","subject","setSubject","grade","setGrade","volume","setVolume","selectedTextbook","setSelectedTextbook","selectedChapters","setSelectedChapters","examType","setExamType","source","setSource","year","setYear","textbooks","setTextbooks","loadingTextbooks","setLoadingTextbooks","uploading","setUploading","uploadProgress","setUploadProgress","uploadResult","setUploadResult","error","setError","useEffect","loadTextbooks","filtered","httpsCallable","functions","t","err","handleFileChange","e","selectedFile","_a","handleChapterToggle","chapter","prev","c","a","b","handleUpload","timestamp","storagePath","storageRef","ref","storage","uploadBytes","fileUrl","getDownloadURL","response","s","g","v","ch","EXAM_TYPE_LABELS","ReferenceExamsList","exams","setExams","loading","setLoading","expandedExam","setExpandedExam","deletingExam","setDeletingExam","loadExams","data","handleDelete","examId","toggleExpand","exam","KnowledgeBaseAdmin","onNavigateToReview","volumeType","setVolumeType","selectedGrades","setSelectedGrades","batchProgressId","setBatchProgressId","continuing","setContinuing","liveProgress","setLiveProgress","searchQuery","setSearchQuery","searchGrade","setSearchGrade","searchVolumeType","setSearchVolumeType","searching","setSearching","searchResults","setSearchResults","stats","setStats","loadingStats","setLoadingStats","books","setBooks","loadingBooks","setLoadingBooks","deletingBook","setDeletingBook","deleteResult","setDeleteResult","migrating","setMigrating","migrationResult","setMigrationResult","activeTab","setActiveTab","loadStats","loadBooks","loadPendingProgress","progressRef","doc","db","unsubscribe","onSnapshot","snapshot","progressQuery","query","collection","orderBy","limit","getDocs","result","handleSearch","handleContinueBatch","handleDeleteBook","book","bookName","bookKey","handleMigrateToTextbooks","creatingReview","setCreatingReview","handleCreateReview","Fragment","isSelected","sg","i","index","kw","count","isDeleting","bgColor","textColor"],"mappings":"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"}