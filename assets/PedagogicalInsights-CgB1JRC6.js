import{r as d,j as e,a6 as y,W as w,k as c,d as h,b as k,aJ as S}from"./index-1x3sw4DL.js";import{PedagogicalTelemetry as p}from"./pedagogicalTelemetry-DR_rp4p-.js";const A=({onBack:i})=>{const[o,x]=d.useState(null),[u,g]=d.useState([]),[n,b]=d.useState({avgScore:0,totalAudits:0,topFailure:""}),[j,m]=d.useState(!0);d.useEffect(()=>{(async()=>{m(!0);try{const t=await p.getRecentAudits(20),r=await p.getCommonFailures();g(t);const a=t.length>0?Math.round(t.reduce((l,v)=>l+v.avgScore,0)/t.length):0;b({avgScore:a,totalAudits:t.length,topFailure:r.length>0?r[0].name:"None"})}catch(t){console.error(t)}finally{m(!1)}})()},[]);const f=({log:s,onClose:t})=>{var r;return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-[200] flex items-center justify-center p-4 animate-fade-in",onClick:t,children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-2xl shadow-2xl overflow-hidden animate-scale-in",onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"bg-purple-900 p-6 text-white flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-bold flex items-center gap-2",children:[e.jsx(k,{className:"w-6 h-6 text-purple-300"}),s.unitTitle]}),e.jsxs("p",{className:"text-purple-200 text-sm mt-1",children:[new Date(((r=s.timestamp)==null?void 0:r.seconds)*1e3).toLocaleString()," | ציון: ",s.avgScore,"%"]})]}),e.jsx("button",{onClick:t,className:"hover:bg-purple-800 p-2 rounded-full transition-colors",children:e.jsx(h,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"p-6 max-h-[70vh] overflow-y-auto",children:s.failedRules.length===0?e.jsxs("div",{className:"text-center py-10 text-green-600",children:[e.jsx(c,{className:"w-16 h-16 mx-auto mb-4 opacity-50"}),e.jsx("h4",{className:"text-xl font-bold",children:"הכל נראה מצוין!"}),e.jsx("p",{className:"text-gray-500",children:"לא נמצאו בעיות פדגוגיות בבדיקה זו."})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"font-bold text-gray-700 flex items-center gap-2 border-b pb-2",children:[e.jsx(S,{className:"w-5 h-5 text-red-500"}),"זוהו ",s.failedRules.length," בעיות לטיפול:"]}),s.failedRules.map((a,l)=>e.jsxs("div",{className:"bg-red-50 p-4 rounded-xl border border-red-100 flex gap-4",children:[e.jsxs("div",{className:"bg-white p-2 rounded-full shadow-sm text-red-500 h-fit shrink-0 font-bold text-xs",children:["#",l+1]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-red-900 text-sm",children:a.ruleName}),e.jsx("p",{className:"text-red-700 text-sm mt-1",children:a.message}),e.jsxs("div",{className:"mt-2 text-xs text-red-400 font-mono bg-red-100/50 px-2 py-1 rounded w-fit",children:["Block ID: ",a.blockId]})]})]},l))]})}),e.jsx("div",{className:"bg-gray-50 p-4 border-t flex justify-end",children:e.jsx("button",{onClick:t,className:"px-6 py-2 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition-colors",children:"סגור"})})]})})},N=s=>s.includes("Feedback")?"Update System Prompt to enforce 'Constructive Feedback' in all outputs.":s.includes("Hint")?"Ensure 'Progressive Hints' are enabled in the learning mode configuration.":s.includes("Question")?"Review content generation prompt to ensure questions are explicitly defined.":s.includes("Wall of Text")?"Adjust 'Chunk Size' parameter in content generation settings.":"Review specific block configurations.";return j?e.jsxs("div",{className:"p-10 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-500 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Loading Insights..."})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50 p-8 font-sans",dir:"ltr",children:[o&&e.jsx(f,{log:o,onClose:()=>x(null)}),e.jsxs("header",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-3",children:[e.jsx(y,{className:"w-8 h-8 text-purple-600"}),"Pedagogical Insights"]}),e.jsx("p",{className:"text-gray-500 mt-1",children:"Real-time analysis of system performance against educational DNA."})]}),i&&e.jsxs("button",{onClick:i,className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 px-4 py-2 rounded-xl border border-gray-200 bg-white shadow-sm",children:[e.jsx(w,{className:"w-4 h-4 rotate-180"})," Back to Dashboard"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-purple-100",children:[e.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-wider mb-2",children:"Network Health (Avg Score)"}),e.jsxs("div",{className:"text-4xl font-black text-purple-900 flex items-center gap-2",children:[n.avgScore,"%",n.avgScore>=90?e.jsx(c,{className:"w-6 h-6 text-green-500"}):e.jsx(h,{className:"w-6 h-6 text-red-500"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-purple-100",children:[e.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-wider mb-2",children:"Total Audits Processed"}),e.jsx("div",{className:"text-4xl font-black text-indigo-900",children:n.totalAudits})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-sm border border-purple-100",children:[e.jsx("h3",{className:"text-gray-400 text-sm font-bold uppercase tracking-wider mb-2",children:"Critical Failure Trend"}),e.jsx("div",{className:"text-lg font-bold text-red-500",children:n.topFailure}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Suggested Fix: ",N(n.topFailure)]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center",children:e.jsx("h3",{className:"font-bold text-gray-800 text-lg",children:"Recent Audit Sessions"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 uppercase font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Timestamp"}),e.jsx("th",{className:"p-4",children:"Unit Name"}),e.jsx("th",{className:"p-4",children:"Mode"}),e.jsx("th",{className:"p-4",children:"Quality Score"}),e.jsx("th",{className:"p-4",children:"Issues Found"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:u.map((s,t)=>{var r;return e.jsxs("tr",{onClick:()=>x(s),className:"hover:bg-purple-50 transition-colors cursor-pointer group",children:[e.jsx("td",{className:"p-4 text-gray-500 group-hover:text-purple-700 font-medium transition-colors",children:new Date(((r=s.timestamp)==null?void 0:r.seconds)*1e3).toLocaleString()}),e.jsx("td",{className:"p-4 font-medium text-gray-800 group-hover:text-purple-900",children:s.unitTitle}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"px-2 py-1 rounded bg-blue-50 text-blue-600 font-bold text-xs uppercase",children:s.mode})}),e.jsx("td",{className:"p-4 font-bold",children:e.jsxs("span",{className:s.avgScore>=90?"text-green-600":s.avgScore>=70?"text-yellow-600":"text-red-600",children:[s.avgScore,"%"]})}),e.jsx("td",{className:"p-4",children:s.failedRules.length===0?e.jsxs("span",{className:"text-green-500 flex items-center gap-1",children:[e.jsx(c,{className:"w-3 h-3"})," Clean"]}):e.jsxs("div",{className:"flex flex-col gap-1",children:[s.failedRules.slice(0,2).map((a,l)=>e.jsx("span",{className:"text-xs text-red-500 bg-red-50 px-1 rounded w-fit",children:a.issue||a.ruleName},l)),s.failedRules.length>2&&e.jsxs("span",{className:"text-xs text-gray-400",children:["+",s.failedRules.length-2," more"]})]})})]},t)})})]})})]})]})};export{A as default};
//# sourceMappingURL=PedagogicalInsights-CgB1JRC6.js.map
