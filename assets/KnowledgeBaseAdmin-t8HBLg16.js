import{j as e,b0 as ve,r as l,A as v,B as N,q as Ne,t as we,u as Ce,v as Se,n as Re,p as je,bB as _e,bz as Ae,aw as Le,c1 as Me,bZ as Qe,bJ as Ue}from"./index-1x3sw4DL.js";const Ie={multiple_choice:"×¨×‘-×‘×¨×™×¨×”",true_false:"× ×›×•×Ÿ/×œ× × ×›×•×Ÿ",open_question:"×©××œ×” ×¤×ª×•×—×”",fill_in_blanks:"×”×©×œ×ž×”",ordering:"×¡×™×“×•×¨",categorization:"×ž×™×•×Ÿ"},qe={remember:"×–×›×™×¨×”",understand:"×”×‘× ×”",apply:"×™×™×©×•×",analyze:"× ×™×ª×•×—",evaluate:"×”×¢×¨×›×”",create:"×™×¦×™×¨×”"},Oe={easy:"×§×œ",medium:"×‘×™× ×•× ×™",hard:"×§×©×”"},Ve={low:"×œ× ×¤×•×¨×ž×œ×™",medium:"×‘×™× ×•× ×™",high:"×¤×•×¨×ž×œ×™"};function xe({label:c,percentage:h,color:d}){return h===0?null:e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-sm text-gray-600 w-20 text-right",children:c}),e.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-4 overflow-hidden",children:e.jsx("div",{className:`h-full ${d} transition-all duration-300`,style:{width:`${h}%`}})}),e.jsxs("span",{className:"text-sm text-gray-700 w-10",children:[h,"%"]})]})}function ke({dna:c,compact:h=!1}){const d=c.extractionConfidence>=.8?"text-green-600":c.extractionConfidence>=.6?"text-yellow-600":"text-red-600";return h?e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[c.questionCount," ×©××œ×•×ª"]}),e.jsxs("span",{children:[c.totalPoints," × ×§×•×“×•×ª"]}),e.jsxs("span",{children:["~",c.estimatedDurationMinutes," ×“×§×•×ª"]}),e.jsxs("span",{className:d,children:["×¨×ž×ª ×‘×™×˜×—×•×Ÿ: ",Math.round(c.extractionConfidence*100),"%"]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:c.questionCount}),e.jsx("p",{className:"text-sm text-gray-600",children:"×©××œ×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:c.totalPoints}),e.jsx("p",{className:"text-sm text-gray-600",children:"× ×§×•×“×•×ª"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["~",c.estimatedDurationMinutes]}),e.jsx("p",{className:"text-sm text-gray-600",children:"×“×§×•×ª"})]})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"×¨×ž×ª ×‘×™×˜×—×•×Ÿ ×‘×—×™×œ×•×¥:"}),e.jsxs("span",{className:`font-semibold ${d}`,children:[Math.round(c.extractionConfidence*100),"%"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"×”×ª×¤×œ×’×•×ª ×¡×•×’×™ ×©××œ×•×ª"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:Object.entries(c.questionTypeDistribution).filter(([o,u])=>u>0).map(([o,u])=>e.jsx(xe,{label:Ie[o]||o,percentage:u,color:"bg-blue-500"},o))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"×”×ª×¤×œ×’×•×ª ×¨×ž×•×ª ×‘×œ×•×"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:Object.entries(c.bloomDistribution).filter(([o,u])=>u>0).map(([o,u])=>e.jsx(xe,{label:qe[o]||o,percentage:u,color:"bg-green-500"},o))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"×”×ª×¤×œ×’×•×ª ×¨×ž×•×ª ×§×•×©×™"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:Object.entries(c.difficultyDistribution).filter(([o,u])=>u>0).map(([o,u])=>e.jsx(xe,{label:Oe[o]||o,percentage:u,color:o==="easy"?"bg-green-400":o==="medium"?"bg-yellow-400":"bg-red-400"},o))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-3",children:"×¡×’× ×•×Ÿ ×œ×©×•× ×™"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"××•×¨×š ×©××œ×” ×ž×ž×•×¦×¢"}),e.jsxs("p",{className:"font-medium",children:[c.linguisticStyle.averageQuestionLengthWords," ×ž×™×œ×™×"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"×¨×ž×ª ×¤×•×¨×ž×œ×™×•×ª"}),e.jsx("p",{className:"font-medium",children:Ve[c.linguisticStyle.formalityLevel]||c.linguisticStyle.formalityLevel})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"×”×§×©×¨ ×™×•×ž×™×•×ž×™"}),e.jsx("p",{className:"font-medium",children:c.linguisticStyle.usesRealWorldContext?"×›×Ÿ":"×œ×"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"××œ×ž× ×˜×™× ×•×™×–×•××œ×™×™×"}),e.jsx("p",{className:"font-medium",children:c.linguisticStyle.usesVisualElements?"×›×Ÿ":"×œ×"})]})]})]})]})}const Ke=[{value:"unit_exam",label:"×ž×‘×—×Ÿ ×™×—×™×“×” / ×¡×™×›×•× ×¤×¨×§"},{value:"midterm",label:"×ž×‘×—×Ÿ ××ž×¦×¢"},{value:"final",label:"×ž×‘×—×Ÿ ×ž×¡×›×"},{value:"quiz",label:"×‘×•×—×Ÿ ×§×¦×¨"}],ze=["×","×‘","×’","×“","×”","×•","×–","×—","×˜","×™","×™×","×™×‘"],Ge=[1,2,3,4,5],ye=[{value:"math",label:"×ž×ª×ž×˜×™×§×”"},{value:"hebrew",label:"×¢×‘×¨×™×ª"},{value:"english",label:"×× ×’×œ×™×ª"},{value:"science",label:"×ž×“×¢×™×"},{value:"history",label:"×”×™×¡×˜×•×¨×™×”"},{value:"other",label:"××—×¨"}];function We({onUploadComplete:c}){var L;const{currentUser:h}=ve(),[d,o]=l.useState(null),[u,j]=l.useState("math"),[w,W]=l.useState("×‘"),[C,U]=l.useState(1),[y,$]=l.useState(""),[p,n]=l.useState([]),[x,B]=l.useState("unit_exam"),[E,Y]=l.useState(""),[i,k]=l.useState(""),[F,A]=l.useState([]),[I,J]=l.useState(!1),[b,X]=l.useState(!1),[D,q]=l.useState(""),[P,se]=l.useState(null),[O,T]=l.useState(null);l.useEffect(()=>{Z()},[w,u,C]);const Z=async()=>{J(!0);try{const S=(await v(N,"getAvailableTextbooks")({})).data.textbooks.filter(R=>R.grade===w&&R.subject===u&&(R.volume===C||R.id.includes(`_${C}_`)));A(S),S.length>0&&!y&&$(S[0].id)}catch(t){console.error("Failed to load textbooks:",t)}finally{J(!1)}},te=t=>{var f;const g=(f=t.target.files)==null?void 0:f[0];if(g){if(g.type!=="application/pdf"){T("×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥ PDF ×‘×œ×‘×“");return}o(g),T(null),se(null)}},V=t=>{n(g=>g.includes(t)?g.filter(f=>f!==t):[...g,t].sort((f,S)=>f-S))},le=async()=>{var t;if(!d){T("×™×© ×œ×‘×—×•×¨ ×§×•×‘×¥");return}if(!y){T("×™×© ×œ×‘×—×•×¨ ×¡×¤×¨ ×œ×™×ž×•×“");return}if(p.length===0){T("×™×© ×œ×‘×—×•×¨ ×œ×¤×—×•×ª ×¤×¨×§ ××—×“");return}X(!0),T(null),q("×ž×¢×œ×” ×§×•×‘×¥...");try{const g=Date.now(),f=`reference-exams/${h==null?void 0:h.uid}/${g}_${d.name}`,S=Ne(we,f);await Ce(S,d);const R=await Se(S);q("×ž×—×œ×¥ DNA ×ž×”×ž×‘×—×Ÿ...");const K=(await v(N,"uploadReferenceExam")({fileUrl:R,storagePath:f,mimeType:"application/pdf",fileName:d.name,subject:u,grade:w,linkedTextbookId:y,chapters:p,examType:x,source:E||void 0,year:i||void 0})).data;se(K),q(""),K.success?(o(null),n([]),Y(""),k(""),c&&c(K)):T(((t=K.errors)==null?void 0:t.join(", "))||"×©×’×™××” ×‘×”×¢×œ××”")}catch(g){console.error("Upload failed:",g),T(g.message||"×©×’×™××” ×‘×”×¢×œ××ª ×”×§×•×‘×¥"),q("")}finally{X(!1)}};return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"×”×¢×œ××ª ×ž×‘×—×Ÿ ×™×™×—×•×¡"}),e.jsx("p",{className:"text-gray-600 text-sm mb-6",children:"×”×¢×œ×” ×ž×‘×—×Ÿ ×§×™×™× (×ž×”×ž×“×¨×™×š ×œ×ž×•×¨×” ××• ×ž×ž×©×¨×“ ×”×—×™× ×•×š) ×•×”×ž×¢×¨×›×ª ×ª×—×œ×¥ ××ª ×”-DNA ×©×œ×• - ×ž×‘× ×”, ×¡×•×’×™ ×©××œ×•×ª, ×¨×ž×•×ª ×§×•×©×™. ×‘×”×ž×©×š, ×”×ž×¢×¨×›×ª ×ª×©×ª×ž×© ×‘-DNA ×”×–×” ×›×ª×‘× ×™×ª ×œ×™×¦×™×¨×ª ×ž×‘×—× ×™× ×—×“×©×™×."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×§×•×‘×¥ PDF ×©×œ ×”×ž×‘×—×Ÿ"}),e.jsx("input",{type:"file",accept:".pdf",onChange:te,className:`block w-full text-sm text-gray-500
              file:mr-4 file:py-2 file:px-4
              file:rounded-md file:border-0
              file:text-sm file:font-semibold
              file:bg-blue-50 file:text-blue-700
              hover:file:bg-blue-100`}),d&&e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["× ×‘×—×¨: ",d.name," (",(d.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×ž×§×¦×•×¢"}),e.jsx("select",{value:u,onChange:t=>{j(t.target.value),$("")},className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:ye.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×›×™×ª×”"}),e.jsx("select",{value:w,onChange:t=>{W(t.target.value),$("")},className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:ze.map(t=>e.jsxs("option",{value:t,children:["×›×™×ª×” ",t,"×³"]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×›×¨×š / ×¡×¤×¨"}),e.jsx("select",{value:C,onChange:t=>{U(parseInt(t.target.value)),$("")},className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:Ge.map(t=>e.jsxs("option",{value:t,children:["×¡×¤×¨ ",t]},t))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©×™×•×š ×œ×¡×¤×¨ ×œ×™×ž×•×“"}),I?e.jsx("p",{className:"text-gray-500 text-sm",children:"×˜×•×¢×Ÿ ×¡×¤×¨×™×..."}):F.length===0?e.jsxs("p",{className:"text-orange-600 text-sm",children:["×œ× × ×ž×¦××• ×¡×¤×¨×™× ×œ×›×™×ª×” ",w,"×³ ×‘×ž×§×¦×•×¢ ",(L=ye.find(t=>t.value===u))==null?void 0:L.label,", ×¡×¤×¨ ",C,". ×™×© ×œ×”×¢×œ×•×ª ×¡×¤×¨ ×œ×™×ž×•×“ ×§×•×“×."]}):e.jsxs("select",{value:y,onChange:t=>$(t.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×‘×—×¨ ×¡×¤×¨..."}),F.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×¤×¨×§×™× ×©×”×ž×‘×—×Ÿ ×ž×›×¡×”"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:[1,2,3,4,5,6,7,8,9,10].map(t=>e.jsxs("button",{type:"button",onClick:()=>V(t),className:`px-3 py-1 rounded-full text-sm ${p.includes(t)?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:["×¤×¨×§ ",t]},t))}),p.length>0&&e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["× ×‘×—×¨×•: ×¤×¨×§×™× ",p.join(", ")]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×¡×•×’ ×”×ž×‘×—×Ÿ"}),e.jsx("select",{value:x,onChange:t=>B(t.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:Ke.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×ž×§×•×¨ (××•×¤×¦×™×•× ×œ×™)"}),e.jsx("input",{type:"text",value:E,onChange:t=>Y(t.target.value),placeholder:"×ž×“×¨×™×š ×œ×ž×•×¨×”, ×ž×©×¨×“ ×”×—×™× ×•×š...",className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×©× ×” (××•×¤×¦×™×•× ×œ×™)"}),e.jsx("input",{type:"number",value:i,onChange:t=>k(t.target.value?parseInt(t.target.value):""),placeholder:"2024",min:2e3,max:2030,className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]}),O&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-700 text-sm",children:O})}),D&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:e.jsx("p",{className:"text-blue-700 text-sm",children:D})}),e.jsx("button",{onClick:le,disabled:b||!d||!y||p.length===0,className:`w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700
            disabled:opacity-50 disabled:cursor-not-allowed`,children:b?"×ž×¢×‘×“...":"×”×¢×œ×” ×•×—×œ×¥ DNA"}),(P==null?void 0:P.success)&&P.examDna&&e.jsxs("div",{className:"mt-6 border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-green-700",children:"DNA ×—×•×œ×¥ ×‘×”×¦×œ×—×”!"}),e.jsx(ke,{dna:P.examDna})]})]})]})}const Ye={unit_exam:"×ž×‘×—×Ÿ ×™×—×™×“×”",midterm:"×ž×‘×—×Ÿ ××ž×¦×¢",final:"×ž×‘×—×Ÿ ×ž×¡×›×",quiz:"×‘×•×—×Ÿ"};function Je(){const[c,h]=l.useState([]),[d,o]=l.useState(!0),[u,j]=l.useState(null),[w,W]=l.useState(null),[C,U]=l.useState(null);l.useEffect(()=>{y()},[]);const y=async()=>{o(!0),j(null);try{const B=(await v(N,"listReferenceExams")({})).data;h(B.exams||[])}catch(n){console.error("Failed to load exams:",n),j(n.message||"×©×’×™××” ×‘×˜×¢×™× ×ª ×ž×‘×—× ×™×")}finally{o(!1)}},$=async n=>{if(window.confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×ž×—×•×§ ××ª ×ž×‘×—×Ÿ ×”×™×™×—×•×¡ ×”×–×”?")){U(n);try{await v(N,"deleteReferenceExam")({examId:n}),h(B=>B.filter(E=>E.id!==n))}catch(x){console.error("Failed to delete exam:",x),alert("×©×’×™××” ×‘×ž×—×™×§×”: "+x.message)}finally{U(null)}}},p=n=>{W(x=>x===n?null:n)};return d?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsx("p",{className:"text-gray-500 text-center",children:"×˜×•×¢×Ÿ ×ž×‘×—× ×™ ×™×™×—×•×¡..."})}):u?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("p",{className:"text-red-600 text-center",children:u}),e.jsx("button",{onClick:y,className:"mt-4 text-blue-600 hover:underline mx-auto block",children:"× ×¡×” ×©×•×‘"})]}):c.length===0?e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center text-gray-500",children:[e.jsx("p",{className:"text-lg mb-2",children:"××™×Ÿ ×¢×“×™×™×Ÿ ×ž×‘×—× ×™ ×™×™×—×•×¡"}),e.jsx("p",{className:"text-sm",children:"×”×¢×œ×” ×ž×‘×—×Ÿ ×§×™×™× ×›×“×™ ×œ×™×¦×•×¨ ×ª×‘× ×™×ª ×œ×™×™×¦×•×¨ ×ž×‘×—× ×™× ×—×“×©×™×"})]})}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["×ž×‘×—× ×™ ×™×™×—×•×¡ (",c.length,")"]}),e.jsx("button",{onClick:y,className:"text-blue-600 hover:underline text-sm",children:"×¨×¢× ×Ÿ"})]}),c.map(n=>e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsxs("div",{className:"p-4 cursor-pointer hover:bg-gray-50 flex items-center justify-between",onClick:()=>p(n.id),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:n.linkedTextbookName}),e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded",children:Ye[n.examType]||n.examType})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["×¤×¨×§×™×: ",n.chapters.join(", ")," | ",n.examDna.questionCount," ×©××œ×•×ª |"," ",n.examDna.totalPoints," × ×§×•×“×•×ª",n.usageCount>0&&e.jsxs("span",{className:"text-green-600 mr-2",children:["(",n.usageCount," ×©×™×ž×•×©×™×)"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:x=>{x.stopPropagation(),$(n.id)},disabled:C===n.id,className:"text-red-500 hover:text-red-700 p-1 disabled:opacity-50",title:"×ž×—×§",children:C===n.id?"...":"ðŸ—‘ï¸"}),e.jsx("span",{className:"text-gray-400",children:w===n.id?"â–²":"â–¼"})]})]}),w===n.id&&e.jsxs("div",{className:"border-t p-4 bg-gray-50",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"×§×•×‘×¥:"}),e.jsx("p",{className:"text-gray-800",children:n.fileName})]}),n.source&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"×ž×§×•×¨:"}),e.jsx("p",{className:"text-gray-800",children:n.source})]}),n.year&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"×©× ×”:"}),e.jsx("p",{className:"text-gray-800",children:n.year})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"×©×™×ž×•×©×™×:"}),e.jsx("p",{className:"text-gray-800",children:n.usageCount})]})]}),e.jsx(ke,{dna:n.examDna})]})]},n.id))]})}const Q=["×","×‘","×’","×“","×”","×•","×–","×—","×˜","×™","×™×","×™×‘"],Xe=[{value:"math",label:"×ž×ª×ž×˜×™×§×”"},{value:"hebrew",label:"×¢×‘×¨×™×ª"},{value:"english",label:"×× ×’×œ×™×ª"},{value:"science",label:"×ž×“×¢×™×"},{value:"history",label:"×”×™×¡×˜×•×¨×™×”"},{value:"other",label:"××—×¨"}];function He({onNavigateToReview:c}){var fe;const{currentUser:h}=ve(),[d,o]=l.useState(null),[u,j]=l.useState(""),[w,W]=l.useState("math"),[C,U]=l.useState("×‘"),[y,$]=l.useState(1),[p,n]=l.useState("student"),[x,B]=l.useState(["×‘"]),[E,Y]=l.useState(!1),[i,k]=l.useState(null),[F,A]=l.useState(null),[I,J]=l.useState(!1),[b,X]=l.useState(null),[D,q]=l.useState(""),[P,se]=l.useState(""),[O,T]=l.useState(""),[Z,te]=l.useState(!1),[V,le]=l.useState([]),[L,t]=l.useState(null),[g,f]=l.useState(!1),[S,R]=l.useState([]),[ae,ie]=l.useState(!1),[K,ge]=l.useState(null),[re,de]=l.useState(null),[oe,he]=l.useState(!1),[ne,ue]=l.useState(null),[_,ce]=l.useState("upload");l.useEffect(()=>{H(),z(),Te()},[]),l.useEffect(()=>{if(!F){X(null);return}const s=Re(je,"extraction_progress",F),r=_e(s,a=>{if(a.exists()){const m=a.data();X({processedPages:m.processedPages||0,totalPages:m.totalPages||0,currentPage:m.currentPage,status:m.status})}},a=>{console.error("Progress listener error:",a)});return()=>r()},[F]);const Te=async()=>{try{const s=Ae(Le(je,"extraction_progress"),Me("createdAt","desc"),Qe(1)),r=await Ue(s);if(!r.empty){const a=r.docs[0],m=a.data();A(a.id),k({success:!1,documentId:a.id,chunksCreated:0,chaptersFound:[],processingTimeMs:0,progress:{processedPages:m.processedPages||0,totalPages:m.totalPages||0,percentComplete:m.totalPages?Math.round(m.processedPages/m.totalPages*100):0}})}}catch(s){console.error("Failed to load pending progress:",s)}},z=async()=>{ie(!0);try{const a=(await v(N,"getKnowledgeBooks")({})).data;R(a.books)}catch(s){console.error("Failed to load books:",s)}finally{ie(!1)}},H=async()=>{f(!0);try{const r=await v(N,"getKnowledgeStats")({});t(r.data)}catch(s){console.error("Failed to load stats:",s)}finally{f(!1)}},$e=s=>{var a;const r=(a=s.target.files)==null?void 0:a[0];r&&(o(r),k(null))},Ee=async()=>{if(!(!d||!h)){Y(!0),k(null),j("×ž×¢×œ×” ×§×•×‘×¥ ×œ-Storage...");try{const s=Date.now(),r=`knowledge-base/${h.uid}/${s}_${d.name}`,a=Ne(we,r);await Ce(a,d);const m=await Se(a);j("×ž×¢×‘×“ ××ª ×”×§×•×‘×¥ ×¢× AI...");const G=(await v(N,"uploadKnowledge",{timeout:3e5})({fileUrl:m,storagePath:r,mimeType:d.type,fileName:d.name,subject:w,grade:p==="curriculum"?x[0]:C,volume:p==="curriculum"?0:y,volumeType:p,...p==="curriculum"&&{grades:x}})).data;k(G),j(""),!G.success&&G.documentId&&G.progress?A(G.documentId):A(null),G.success&&(H(),z())}catch(s){console.error("Upload failed:",s),j(""),k({success:!1,documentId:"",chunksCreated:0,chaptersFound:[],processingTimeMs:0,errors:[s.message]})}finally{Y(!1)}}},pe=async()=>{if(D.trim()){te(!0),le([]);try{const a=(await v(N,"searchKnowledge")({query:D,filters:{subject:"math",...P&&{grade:P},...O&&{volumeType:O}},limit:10})).data;le(a.results)}catch(s){console.error("Search failed:",s)}finally{te(!1)}}},Fe=async()=>{if(!(!F||!h)){J(!0),j("×ž×ž×©×™×š ×‘×¢×™×‘×•×“ ×”×¡×¤×¨...");try{const a=(await v(N,"continueKnowledgeExtraction",{timeout:6e5})({progressId:F})).data;k(a),j(""),!a.success&&a.documentId&&a.progress?A(a.documentId):(A(null),a.success&&(H(),z()))}catch(s){console.error("Continue batch failed:",s),j(""),k({success:!1,documentId:F,chunksCreated:0,chaptersFound:[],processingTimeMs:0,errors:[s.message]})}finally{J(!1)}}},Pe=async s=>{const r=s.volumeType==="teacher"?"×ž×“×¨×™×š ×œ×ž×•×¨×”":"×¡×¤×¨ ×ª×œ×ž×™×“";if(!window.confirm(`×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ×ž×—×•×§ ××ª ${r} ×›×™×ª×” ${s.grade}' ×›×¨×š ${s.volume}?

×¤×¢×•×œ×” ×–×• ××™× ×” ×”×¤×™×›×”!`))return;const a=`${s.grade}-${s.volume}-${s.volumeType}`;ge(a),de(null);try{const ee=(await v(N,"deleteKnowledgeBook",{timeout:3e5})({grade:s.grade,volume:s.volume,volumeType:s.volumeType})).data;de({success:ee.success,message:ee.message}),H(),z()}catch(m){console.error("Delete failed:",m),de({success:!1,message:m.message||"×©×’×™××” ×‘×ž×—×™×§×”"})}finally{ge(null)}},Be=async()=>{if(window.confirm(`×”×× ×œ×¡× ×›×¨×Ÿ ××ª ×›×œ ×”×¡×¤×¨×™× ×ž×‘×¡×™×¡ ×”×™×“×¢ ×œ×ž×¢×¨×›×ª ×”×¡×¤×¨×™×?

×¤×¢×•×œ×” ×–×• ×ª×™×¦×•×¨ ×¨×©×•×ž×•×ª ×¡×¤×¨ ×¢×‘×•×¨ ×›×œ ×”×¡×¤×¨×™× ×©×§×™×™×ž×™× ×‘×‘×¡×™×¡ ×”×™×“×¢.`)){he(!0),ue(null);try{const a=(await v(N,"migrateKnowledgeBooksToTextbooks",{timeout:54e4})({})).data;ue({success:a.success,message:`×¡× ×›×¨×•×Ÿ ×”×•×©×œ×!
× ×ž×¦××• ${a.totalBooks} ×¡×¤×¨×™×
× ×•×¦×¨×• ${a.created} ×¨×©×•×ž×•×ª ×—×“×©×•×ª
× ×›×©×œ×• ${a.failed}`}),z()}catch(s){console.error("Migration failed:",s),ue({success:!1,message:s.message||"×©×’×™××” ×‘×¡× ×›×¨×•×Ÿ"})}finally{he(!1)}}},[me,be]=l.useState(null),De=async s=>{const r=`${s.grade}-${s.volume}-${s.volumeType}`;be(r);try{const M=(await v(N,"createReviewForExistingBook")({grade:s.grade,volume:s.volume,volumeType:s.volumeType,...s.volumeType==="curriculum"&&s.grades&&{grades:s.grades}})).data;M.success&&(alert(`× ×•×¦×¨×” ×¡×§×™×¨×” ×‘×”×¦×œ×—×”!
×ž×–×”×”: ${M.reviewId}
×¢×ž×•×“×™×: ${M.totalPages}`),c&&c())}catch(a){console.error("Create review failed:",a),alert("×©×’×™××” ×‘×™×¦×™×¨×ª ×¡×§×™×¨×”: "+a.message)}finally{be(null)}};return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",dir:"rtl",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"×‘×¡×™×¡ ×”×™×“×¢ - ×ž×ª×ž×˜×™×§×”"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"× ×™×”×•×œ ×ª×•×›×Ÿ ×ž×ª×ž×˜×™ ×œ×©×™×ž×•×© ×‘×™×¦×™×¨×ª ×©××œ×•×ª ×•×ª×›× ×™× ×—×›×ž×™×"})]}),c&&e.jsxs("button",{onClick:c,className:"px-4 py-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”"}),"×¡×§×™×¨×ª ×—×™×œ×•×¥ ×˜×§×¡×˜"]})]}),e.jsxs("div",{className:"flex gap-4 mb-6 border-b",children:[e.jsx("button",{onClick:()=>ce("upload"),className:`px-4 py-2 font-medium ${_==="upload"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"×”×¢×œ××ª ×¡×¤×¨"}),e.jsx("button",{onClick:()=>ce("search"),className:`px-4 py-2 font-medium ${_==="search"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"×—×™×¤×•×©"}),e.jsx("button",{onClick:()=>ce("stats"),className:`px-4 py-2 font-medium ${_==="stats"?"border-b-2 border-blue-500 text-blue-600":"text-gray-500 hover:text-gray-700"}`,children:"×¡×˜×˜×™×¡×˜×™×§×•×ª"}),e.jsx("button",{onClick:()=>ce("reference_exams"),className:`px-4 py-2 font-medium ${_==="reference_exams"?"border-b-2 border-purple-500 text-purple-600":"text-gray-500 hover:text-gray-700"}`,children:"×ž×‘×—× ×™ ×™×™×—×•×¡"})]}),_==="upload"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"×”×¢×œ××ª ×¡×¤×¨ ×—×“×©"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×§×•×‘×¥ PDF"}),e.jsx("input",{type:"file",accept:".pdf",onChange:$e,className:`block w-full text-sm text-gray-500\r
                    file:mr-4 file:py-2 file:px-4\r
                    file:rounded-md file:border-0\r
                    file:text-sm file:font-semibold\r
                    file:bg-blue-50 file:text-blue-700\r
                    hover:file:bg-blue-100`}),d&&e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["× ×‘×—×¨: ",d.name," (",(d.size/1024/1024).toFixed(2)," MB)"]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×ž×§×¦×•×¢"}),e.jsx("select",{value:w,onChange:s=>W(s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:Xe.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×¡×•×’"}),e.jsxs("select",{value:p,onChange:s=>n(s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"student",children:"×¡×¤×¨ ×ª×œ×ž×™×“"}),e.jsx("option",{value:"teacher",children:"×ž×“×¨×™×š ×œ×ž×•×¨×”"}),e.jsx("option",{value:"curriculum",children:"×ª×•×›× ×™×ª ×œ×™×ž×•×“×™×"})]})]}),p!=="curriculum"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×›×™×ª×”"}),e.jsx("select",{value:C,onChange:s=>U(s.target.value),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:Q.map(s=>e.jsxs("option",{value:s,children:["×›×™×ª×” ",s,"×³"]},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"×›×¨×š"}),e.jsx("input",{type:"number",min:1,max:10,value:y,onChange:s=>$(parseInt(s.target.value)||1),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})]})]}),p==="curriculum"&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("label",{className:"block text-sm font-medium text-green-800 mb-2",children:"×©×›×‘×•×ª (× ×™×ª×Ÿ ×œ×‘×—×•×¨ ×ž×¡×¤×¨ ×›×™×ª×•×ª)"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Q.map(s=>{const r=x.includes(s);return e.jsxs("button",{type:"button",onClick:()=>{r?x.length>1&&B(x.filter(a=>a!==s)):B([...x,s])},className:`px-3 py-1.5 rounded-md text-sm font-medium transition-colors ${r?"bg-green-600 text-white":"bg-white text-green-700 border border-green-300 hover:bg-green-100"}`,children:[s,"×³"]},s)})}),e.jsxs("p",{className:"mt-2 text-xs text-green-600",children:["× ×‘×—×¨×•: ",x.sort((s,r)=>Q.indexOf(s)-Q.indexOf(r)).map(s=>`${s}×³`).join(", ")]})]}),e.jsx("button",{onClick:Ee,disabled:!d||E,className:`w-full py-3 px-4 rounded-md font-medium text-white ${!d||E?"bg-gray-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:E?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),u||"×ž×¢×‘×“... (×–×” ×™×›×•×œ ×œ×§×—×ª ×›×ž×” ×“×§×•×ª)"]}):"×”×¢×œ×” ×•××¨×’×Ÿ"}),(E||I)&&b&&b.totalPages>0&&e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:["×ž×¢×‘×“ ×¢×ž×•×“ ",b.currentPage||b.processedPages," ×ž×ª×•×š ",b.totalPages]}),e.jsxs("span",{className:"text-sm font-bold text-blue-600",children:[Math.round(b.processedPages/b.totalPages*100),"%"]})]}),e.jsx("div",{className:"w-full h-3 bg-blue-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full transition-all duration-500 ease-out",style:{width:`${b.processedPages/b.totalPages*100}%`}})}),e.jsx("p",{className:"mt-2 text-xs text-blue-600",children:b.status==="processing"?"×ž×—×œ×¥ ×˜×§×¡×˜ ×¢× AI...":b.status==="saving"?"×©×•×ž×¨ ×œ×‘×¡×™×¡ ×”× ×ª×•× ×™×...":"×ž×¢×‘×“..."})]}),i&&e.jsx("div",{className:`mt-4 p-4 rounded-md ${i.success?"bg-green-50 border border-green-200":i.progress?"bg-blue-50 border border-blue-200":"bg-red-50 border border-red-200"}`,children:i.success?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-medium text-green-800",children:"×”×¢×œ××” ×”×¦×œ×™×—×”!"}),e.jsxs("ul",{className:"mt-2 text-sm text-green-700 space-y-1",children:[e.jsxs("li",{children:["× ×•×¦×¨×• ",i.chunksCreated," ×§×˜×¢×™×"]}),e.jsxs("li",{children:["×–×ž×Ÿ ×¢×™×‘×•×“: ",(i.processingTimeMs/1e3).toFixed(1)," ×©× ×™×•×ª"]}),e.jsxs("li",{children:["×¤×¨×§×™× ×©× ×ž×¦××•: ",i.chaptersFound.join(", ")||"×œ× ×–×•×”×• ×¤×¨×§×™×"]})]}),i.extractionQuality&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-green-200",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"××™×›×•×ª ×”×—×™×œ×•×¥:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-green-700",children:"×©×™×˜×”:"}),e.jsx("span",{className:`text-xs px-2 py-1 rounded ${i.extractionQuality.method==="high_quality"||i.extractionQuality.method==="high_quality_batch"?"bg-green-200 text-green-800":"bg-yellow-200 text-yellow-800"}`,children:i.extractionQuality.method==="high_quality"?"×—×™×œ×•×¥ ×‘××™×›×•×ª ×’×‘×•×”×” (Gemini)":i.extractionQuality.method==="high_quality_batch"?"×—×™×œ×•×¥ ×‘××™×›×•×ª ×’×‘×•×”×” - Batch (Gemini)":i.extractionQuality.method})]}),i.extractionQuality.averageConfidence!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-green-700",children:"×¨×ž×ª ×•×“××•×ª:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-32 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${i.extractionQuality.averageConfidence>=.9?"bg-green-500":i.extractionQuality.averageConfidence>=.8?"bg-yellow-500":"bg-red-500"}`,style:{width:`${i.extractionQuality.averageConfidence*100}%`}})}),e.jsxs("span",{className:`text-sm font-medium ${i.extractionQuality.averageConfidence>=.9?"text-green-700":i.extractionQuality.averageConfidence>=.8?"text-yellow-700":"text-red-700"}`,children:[(i.extractionQuality.averageConfidence*100).toFixed(1),"%"]})]})]}),i.extractionQuality.pagesNeedingReview&&i.extractionQuality.pagesNeedingReview.length>0&&e.jsxs("div",{className:"mt-2 p-2 bg-yellow-100 border border-yellow-300 rounded",children:[e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"×¢×ž×•×“×™× ×”×“×•×¨×©×™× ×‘×“×™×§×” ×™×“× ×™×ª:"}),e.jsxs("p",{className:"text-sm text-yellow-700",children:["×¢×ž×•×“×™× ",i.extractionQuality.pagesNeedingReview.join(", ")]})]})]})]})]}):i.progress?e.jsxs(e.Fragment,{children:[e.jsxs("h3",{className:"font-medium text-blue-800 flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“š"}),"×¢×™×‘×•×“ ×¡×¤×¨ ×’×“×•×œ ×‘×”×ª×§×“×ž×•×ª"]}),e.jsxs("div",{className:"mt-3 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-blue-700",children:"×”×ª×§×“×ž×•×ª:"}),e.jsx("div",{className:"flex-1 h-4 bg-blue-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 transition-all duration-300",style:{width:`${i.progress.percentComplete}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-blue-800",children:[i.progress.percentComplete,"%"]})]}),e.jsxs("p",{className:"text-sm text-blue-700",children:["×¢×ž×•×“×™×: ",i.progress.processedPages," / ",i.progress.totalPages]}),e.jsx("p",{className:"text-xs text-blue-600",children:"×¡×¤×¨×™× ×’×“×•×œ×™× ×ž×¢×•×‘×“×™× ×‘×—×œ×§×™× (40 ×¢×ž×•×“×™× ×‘×›×œ ×¤×¢×) ×‘×’×œ×œ ×ž×’×‘×œ×•×ª ×–×ž×Ÿ."}),e.jsx("button",{onClick:Fe,disabled:I,className:`w-full py-3 px-4 rounded-md font-medium text-white ${I?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:I?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),u||"×ž×ž×©×™×š ×‘×¢×™×‘×•×“..."]}):"â–¶ï¸ ×”×ž×©×š ×¢×™×‘×•×“"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"font-medium text-red-800",children:"×”×¢×œ××” × ×›×©×œ×”"}),e.jsx("ul",{className:"mt-2 text-sm text-red-700",children:(fe=i.errors)==null?void 0:fe.map((s,r)=>e.jsx("li",{children:s},r))})]})})]})]}),_==="search"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"×—×™×¤×•×© ×‘×‘×¡×™×¡ ×”×™×“×¢"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{type:"text",value:D,onChange:s=>q(s.target.value),placeholder:"×—×¤×© × ×•×©×... (×œ×ž×©×œ: ×—×™×‘×•×¨ ×¢×“ 100, ×©×‘×¨×™×, ×©×˜×— ×ž×œ×‘×Ÿ)",className:"flex-1 rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",onKeyDown:s=>s.key==="Enter"&&pe()}),e.jsx("button",{onClick:pe,disabled:Z||!D.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:bg-gray-400",children:Z?"×ž×—×¤×©...":"×—×¤×©"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("select",{value:P,onChange:s=>se(s.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×›×œ ×”×›×™×ª×•×ª"}),Q.map(s=>e.jsxs("option",{value:s,children:["×›×™×ª×” ",s,"×³"]},s))]}),e.jsxs("select",{value:O,onChange:s=>T(s.target.value),className:"rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"×›×œ ×”×¡×•×’×™×"}),e.jsx("option",{value:"student",children:"×¡×¤×¨ ×ª×œ×ž×™×“"}),e.jsx("option",{value:"teacher",children:"×ž×“×¨×™×š ×œ×ž×•×¨×”"}),e.jsx("option",{value:"curriculum",children:"×ª×•×›× ×™×ª ×œ×™×ž×•×“×™×"})]})]}),V.length>0&&e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("h3",{className:"font-medium text-gray-700",children:["× ×ž×¦××• ",V.length," ×ª×•×¦××•×ª:"]}),V.map((s,r)=>e.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.chunk.chapter}),e.jsxs("span",{className:"text-sm text-gray-500 mr-2",children:["(×›×™×ª×” ",s.chunk.grade,"×³, ×›×¨×š ",s.chunk.volume,",",s.chunk.volumeType==="teacher"?" ×ž×“×¨×™×š ×œ×ž×•×¨×”":s.chunk.volumeType==="curriculum"?" ×ª×•×›× ×™×ª ×œ×™×ž×•×“×™×":" ×¡×¤×¨ ×ª×œ×ž×™×“",")"]})]}),e.jsxs("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded",children:[(s.similarity*100).toFixed(0),"% ×”×ª××ž×”"]})]}),e.jsx("p",{className:"text-gray-600 text-sm line-clamp-3",children:s.chunk.content}),e.jsxs("div",{className:"mt-2 flex gap-2",children:[e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:s.chunk.contentType}),s.chunk.keywords.slice(0,3).map(a=>e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:a},a))]})]},s.chunk.id))]}),V.length===0&&D&&!Z&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"×œ× × ×ž×¦××• ×ª×•×¦××•×ª. × ×¡×” ×ž×•× ×—×™× ××—×¨×™×."})]})]}),_==="stats"&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"×¡×˜×˜×™×¡×˜×™×§×•×ª ×‘×¡×™×¡ ×”×™×“×¢"}),e.jsx("button",{onClick:H,disabled:g,className:"text-blue-600 hover:text-blue-800",children:g?"×˜×•×¢×Ÿ...":"×¨×¢× ×Ÿ"})]}),L?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900",children:"×¡×”×´×› ×§×˜×¢×™×"}),e.jsx("p",{className:"text-4xl font-bold text-blue-600 mt-2",children:L.totalChunks.toLocaleString()})]}),e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-green-900",children:"×œ×¤×™ ×›×™×ª×”"}),e.jsx("div",{className:"mt-2 space-y-1",children:Object.entries(L.byGrade).sort(([s],[r])=>Q.indexOf(s)-Q.indexOf(r)).map(([s,r])=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:["×›×™×ª×” ",s,"×³"]}),e.jsx("span",{className:"font-medium",children:r})]},s))})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-purple-900",children:"×œ×¤×™ ×¡×•×’"}),e.jsx("div",{className:"mt-2 space-y-1",children:Object.entries(L.byVolumeType).map(([s,r])=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:s==="student"?"×¡×¤×¨ ×ª×œ×ž×™×“":s==="teacher"?"×ž×“×¨×™×š ×œ×ž×•×¨×”":s==="curriculum"?"×ª×•×›× ×™×ª ×œ×™×ž×•×“×™×":s}),e.jsx("span",{className:"font-medium",children:r})]},s))})]})]}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:g?"×˜×•×¢×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª...":"××™×Ÿ × ×ª×•× ×™× ×¢×“×™×™×Ÿ"}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"×¡×¤×¨×™× ×‘×‘×¡×™×¡ ×”×™×“×¢"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Be,disabled:oe,className:`px-3 py-1.5 rounded-md text-sm font-medium ${oe?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:oe?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"×ž×¡× ×›×¨×Ÿ..."]}):"ðŸ”„ ×¡× ×›×¨×Ÿ ×œ×ž×¢×¨×›×ª ×¡×¤×¨×™×"}),e.jsx("button",{onClick:z,disabled:ae,className:"text-blue-600 hover:text-blue-800 text-sm",children:ae?"×˜×•×¢×Ÿ...":"×¨×¢× ×Ÿ"})]})]}),ne&&e.jsx("div",{className:`mb-4 p-3 rounded-md whitespace-pre-line ${ne.success?"bg-green-100 border border-green-300":"bg-red-100 border border-red-300"}`,children:e.jsx("p",{className:ne.success?"text-green-800":"text-red-800",children:ne.message})}),re&&e.jsx("div",{className:`mb-4 p-3 rounded-md ${re.success?"bg-green-100 border border-green-300":"bg-red-100 border border-red-300"}`,children:e.jsx("p",{className:re.success?"text-green-800":"text-red-800",children:re.message})}),ae?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"×˜×•×¢×Ÿ ×¨×©×™×ž×ª ×¡×¤×¨×™×..."}):S.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"××™×Ÿ ×¡×¤×¨×™× ×‘×‘×¡×™×¡ ×”×™×“×¢"}):e.jsx("div",{className:"space-y-2",children:S.map(s=>{const r=`${s.grade}-${s.volume}-${s.volumeType}`,a=K===r,m=s.volumeType==="teacher"?"×ž×“×¨×™×š ×œ×ž×•×¨×”":s.volumeType==="curriculum"?"×ª×•×›× ×™×ª ×œ×™×ž×•×“×™×":"×¡×¤×¨ ×ª×œ×ž×™×“",M=s.volumeType==="teacher"?"bg-purple-50 border-purple-200":s.volumeType==="curriculum"?"bg-green-50 border-green-200":"bg-blue-50 border-blue-200",ee=s.volumeType==="teacher"?"text-purple-700":s.volumeType==="curriculum"?"text-green-700":"text-blue-700";return e.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg border ${M}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:s.volumeType==="teacher"?"ðŸ‘¨â€ðŸ«":s.volumeType==="curriculum"?"ðŸ“‹":"ðŸ“–"}),e.jsxs("div",{children:[e.jsx("div",{className:`font-medium ${ee}`,children:s.volumeType==="curriculum"?`${m} - ${s.grades&&s.grades.length>0?`×›×™×ª×•×ª ${s.grades.join("×³, ")}×³`:`×›×™×ª×” ${s.grade}×³`}`:`${m} - ×›×™×ª×” ${s.grade}×³ ×›×¨×š ${s.volume}`}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.chunksCount," ×§×˜×¢×™×"]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>De(s),disabled:me===r,className:`px-3 py-1.5 rounded-md text-sm font-medium ${me===r?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-yellow-100 text-yellow-700 hover:bg-yellow-200"}`,children:me===r?"×™×•×¦×¨...":"ðŸ” ×¡×§×™×¨×”"}),e.jsx("button",{onClick:()=>Pe(s),disabled:a,className:`px-3 py-1.5 rounded-md text-sm font-medium ${a?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-red-100 text-red-700 hover:bg-red-200"}`,children:a?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsxs("svg",{className:"animate-spin h-3 w-3",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}),"×ž×•×—×§..."]}):"ðŸ—‘ï¸ ×ž×—×§"})]})]},r)})})]})]}),_==="reference_exams"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-purple-800 mb-2",children:"×ž×‘×—× ×™ ×™×™×—×•×¡"}),e.jsx("p",{className:"text-purple-700 text-sm",children:"×ž×‘×—× ×™ ×™×™×—×•×¡ ×”× ×ž×‘×—× ×™× ×§×™×™×ž×™× (×ž×“×¨×™×›×™ ×ž×•×¨×”, ×ž×©×¨×“ ×”×—×™× ×•×š) ×©×ž×©×ž×©×™× ×›×ª×‘× ×™×•×ª ×œ×™×¦×™×¨×ª ×ž×‘×—× ×™× ×—×“×©×™×. ×”×ž×¢×¨×›×ª ×ž×—×œ×¦×ª ××ª ×”-DNA ×©×œ ×”×ž×‘×—×Ÿ (×ž×‘× ×”, ×¡×•×’×™ ×©××œ×•×ª, ×¨×ž×•×ª ×§×•×©×™) ×•×ž×©×ª×ž×©×ª ×‘×• ×œ×™×™×¦×¨ ×ž×‘×—× ×™× ×¢× ××•×ª×• ×ž×‘× ×” ××‘×œ ×©××œ×•×ª ×—×“×©×•×ª ×ž×ª×•×›×Ÿ ×”×¡×¤×¨."})]}),e.jsx(We,{onUploadComplete:()=>{}}),e.jsx(Je,{})]})]})})}export{He as default};
//# sourceMappingURL=KnowledgeBaseAdmin-t8HBLg16.js.map
