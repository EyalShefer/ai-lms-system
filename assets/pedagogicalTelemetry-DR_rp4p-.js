import{bz as m,aw as n,p as i,c1 as g,bZ as p,bJ as f,ax as h,av as y}from"./index-1x3sw4DL.js";const l="pedagogical_audits",b={logAuditSession:async(o,a,t,e)=>{try{const c=Math.round(e.reduce((r,s)=>r+s.score,0)/e.length),d=e.flatMap(r=>r.rules.filter(s=>s.status!=="PASS").map(s=>({ruleId:s.id,ruleName:s.name,blockId:r.blockId,blockType:"unknown",message:s.message}))),u={unitId:o,unitTitle:a,mode:t,avgScore:c,timestamp:h(),failedRules:d};return await y(n(i,l),u),!0}catch(c){return console.error("❌ Failed to log pedagogical audit:",c),!1}},getRecentAudits:async(o=20)=>{try{const a=m(n(i,l),g("timestamp","desc"),p(o));return(await f(a)).docs.map(e=>({...e.data(),id:e.id}))}catch(a){return console.error("❌ Failed to fetch audits:",a),[]}},getCommonFailures:async()=>{const o=await b.getRecentAudits(50),a={};return o.forEach(t=>{t.failedRules.forEach(e=>{a[e.ruleName]=(a[e.ruleName]||0)+1})}),Object.entries(a).sort(([,t],[,e])=>e-t).map(([t,e])=>({name:t,count:e}))}};export{b as PedagogicalTelemetry};
//# sourceMappingURL=pedagogicalTelemetry-DR_rp4p-.js.map
