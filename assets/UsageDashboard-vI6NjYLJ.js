import{c as w,b0 as A,r as l,j as e,bq as b,H as v,A as E,B as _}from"./index-1x3sw4DL.js";import{I as R}from"./IconUsers-Br9myKfl.js";import{I as D}from"./IconChartBar-C9Gh53Hd.js";import{I as o}from"./IconChevronUp-CahN5a1t.js";import{I as m}from"./IconChevronDown-BNmdE9By.js";/**
 * @license @tabler/icons-react v3.36.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M3 21l18 0",key:"svg-0"}],["path",{d:"M9 8l1 0",key:"svg-1"}],["path",{d:"M9 12l1 0",key:"svg-2"}],["path",{d:"M9 16l1 0",key:"svg-3"}],["path",{d:"M14 8l1 0",key:"svg-4"}],["path",{d:"M14 12l1 0",key:"svg-5"}],["path",{d:"M14 16l1 0",key:"svg-6"}],["path",{d:"M5 21v-16a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v16",key:"svg-7"}]],f=w("outline","building","Building",B);/**
 * @license @tabler/icons-react v3.36.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M9 14c0 1.657 2.686 3 6 3s6 -1.343 6 -3s-2.686 -3 -6 -3s-6 1.343 -6 3z",key:"svg-0"}],["path",{d:"M9 14v4c0 1.656 2.686 3 6 3s6 -1.344 6 -3v-4",key:"svg-1"}],["path",{d:"M3 6c0 1.072 1.144 2.062 3 2.598s4.144 .536 6 0c1.856 -.536 3 -1.526 3 -2.598c0 -1.072 -1.144 -2.062 -3 -2.598s-4.144 -.536 -6 0c-1.856 .536 -3 1.526 -3 2.598z",key:"svg-2"}],["path",{d:"M3 6v10c0 .888 .772 1.45 2 2",key:"svg-3"}],["path",{d:"M3 11c0 .888 .772 1.45 2 2",key:"svg-4"}]],L=w("outline","coins","Coins",F),T={free:"bg-slate-100 text-slate-700",basic:"bg-blue-100 text-blue-700",pro:"bg-purple-100 text-purple-700",enterprise:"bg-amber-100 text-amber-700"},z={free:"חינמי",basic:"בסיסי",pro:"מקצועי",enterprise:"ארגוני"},K=({className:h=""})=>{const{isAdmin:n}=A(),[a,y]=l.useState([]),[x,p]=l.useState(!0),[g,j]=l.useState(null),[r,k]=l.useState("percentUsed"),[c,u]=l.useState("desc"),N=async()=>{if(n){p(!0),j(null);try{const d=(await E(_,"getAllUsage")()).data;y(d.institutions||[])}catch(s){console.error("Error fetching usage data:",s),j(s.message||"שגיאה בטעינת נתונים")}finally{p(!1)}}};l.useEffect(()=>{N()},[n]);const i=s=>{r===s?u(c==="asc"?"desc":"asc"):(k(s),u("desc"))},I=[...a].sort((s,t)=>{const d=c==="asc"?1:-1;switch(r){case"name":return d*s.name.localeCompare(t.name,"he");case"percentUsed":return d*(s.percentUsed-t.percentUsed);case"tokens":return d*(s.usage.tokens-t.usage.tokens);default:return 0}}),U=a.length,C=a.filter(s=>s.status==="active").length,M=a.reduce((s,t)=>s+t.usage.tokens,0),S=a.reduce((s,t)=>s+t.usage.cost,0),$=a.filter(s=>s.percentUsed>=80).length;return n?e.jsxs("div",{className:`space-y-6 ${h}`,dir:"rtl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"דשבורד שימוש"}),e.jsx("p",{className:"text-slate-600",children:"ניטור שימוש ב-AI לכל המוסדות"})]}),e.jsxs("button",{onClick:N,disabled:x,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(v,{className:`w-4 h-4 ${x?"animate-spin":""}`}),"רענן"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(f,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"מוסדות"}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:U})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(R,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"פעילים"}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:C})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:e.jsx(D,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"טוקנים החודש"}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:M.toLocaleString()})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-amber-100 rounded-lg",children:e.jsx(L,{className:"w-5 h-5 text-amber-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"עלות משוערת"}),e.jsxs("p",{className:"text-xl font-bold text-slate-800",children:["$",S.toFixed(2)]})]})]})}),e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-slate-200",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(b,{className:"w-5 h-5 text-red-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600",children:"מתקרבים למכסה"}),e.jsx("p",{className:"text-xl font-bold text-slate-800",children:$})]})]})})]}),g&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 rounded-lg p-4",children:g}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden",children:[e.jsx("div",{className:"p-4 border-b border-slate-200",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"מוסדות"})}),x?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(v,{className:"w-8 h-8 text-slate-400 animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"טוען נתונים..."})]}):a.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(f,{className:"w-12 h-12 text-slate-300 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600",children:"אין מוסדות להצגה"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600 cursor-pointer hover:bg-slate-100",onClick:()=>i("name"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["שם המוסד",r==="name"&&(c==="asc"?e.jsx(o,{className:"w-4 h-4"}):e.jsx(m,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600",children:"רישיון"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600",children:"סטטוס"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600 cursor-pointer hover:bg-slate-100",onClick:()=>i("tokens"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["טוקנים",r==="tokens"&&(c==="asc"?e.jsx(o,{className:"w-4 h-4"}):e.jsx(m,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600",children:"תמונות"}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600 cursor-pointer hover:bg-slate-100",onClick:()=>i("percentUsed"),children:e.jsxs("div",{className:"flex items-center gap-1",children:["שימוש",r==="percentUsed"&&(c==="asc"?e.jsx(o,{className:"w-4 h-4"}):e.jsx(m,{className:"w-4 h-4"}))]})}),e.jsx("th",{className:"px-4 py-3 text-right text-sm font-medium text-slate-600",children:"עלות"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-200",children:I.map(s=>e.jsxs("tr",{className:"hover:bg-slate-50",children:[e.jsx("td",{className:"px-4 py-3",children:e.jsx("div",{className:"font-medium text-slate-800",children:s.name})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T[s.tier]}`,children:z[s.tier]})}),e.jsx("td",{className:"px-4 py-3",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${s.status==="active"?"bg-green-100 text-green-700":s.status==="grace_period"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:s.status==="active"?"פעיל":s.status==="grace_period"?"תקופת חסד":s.status==="expired"?"פג תוקף":s.status})}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:s.usage.tokens.toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-slate-700",children:s.usage.images}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-24 h-2 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${s.percentUsed>=95?"bg-red-500":s.percentUsed>=80?"bg-amber-500":"bg-green-500"}`,style:{width:`${Math.min(s.percentUsed,100)}%`}})}),e.jsxs("span",{className:`text-sm font-medium ${s.percentUsed>=95?"text-red-600":s.percentUsed>=80?"text-amber-600":"text-slate-600"}`,children:[s.percentUsed,"%"]})]})}),e.jsxs("td",{className:"px-4 py-3 text-slate-700",children:["$",s.usage.cost.toFixed(2)]})]},s.id))})]})})]})]}):e.jsxs("div",{className:`bg-white rounded-xl p-8 text-center ${h}`,children:[e.jsx(b,{className:"w-12 h-12 text-amber-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:"אין הרשאה"}),e.jsx("p",{className:"text-slate-600",children:"רק מנהלי מערכת יכולים לצפות בדשבורד זה"})]})};export{K as UsageDashboard,K as default};
//# sourceMappingURL=UsageDashboard-vI6NjYLJ.js.map
